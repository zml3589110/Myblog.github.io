<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>赵逸尘个人博客</title>
  
  <subtitle>记录工作生活</subtitle>
  <link href="https://zml3589110.github.io/atom.xml" rel="self"/>
  
  <link href="https://zml3589110.github.io/"/>
  <updated>2022-07-23T03:12:42.158Z</updated>
  <id>https://zml3589110.github.io/</id>
  
  <author>
    <name>ZhaoYichen</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>VBA窗体相关设置汇总</title>
    <link href="https://zml3589110.github.io/posts/2061956688.html"/>
    <id>https://zml3589110.github.io/posts/2061956688.html</id>
    <published>2022-07-23T03:10:20.000Z</published>
    <updated>2022-07-23T03:12:42.158Z</updated>
    
    <content type="html"><![CDATA[<h1 id="VBA去掉窗体的背景图片"><a href="#VBA去掉窗体的背景图片" class="headerlink" title="VBA去掉窗体的背景图片"></a>VBA去掉窗体的背景图片</h1><ul><li>解决办法1：在窗体中属性里找 picture，选中（Bitmap），然后 del 就可以清除</li><li>解决办法2：在代码里添加代码：Me.Picture &#x3D; Nothing</li></ul><hr><h1 id="相关链接"><a href="#相关链接" class="headerlink" title="相关链接"></a>相关链接</h1><ol><li><a href="https://zhidao.baidu.com/question/623726551390256772.html">在VB中怎么去掉窗体的背景图片？</a></li></ol><hr><center><font color="red">=================我是分割线=================</font></center><p><strong>欢迎到公众号来唠嗑:</strong></p><img src="https://pic4.zhimg.com/80/v2-eedc5dc7d30beedf4c2f1812df8e61a7_720w.jpg">]]></content>
    
    
    <summary type="html">VBA窗体相关设置处理汇总</summary>
    
    
    
    <category term="编程类" scheme="https://zml3589110.github.io/categories/%E7%BC%96%E7%A8%8B%E7%B1%BB/"/>
    
    <category term="VBA" scheme="https://zml3589110.github.io/categories/%E7%BC%96%E7%A8%8B%E7%B1%BB/VBA/"/>
    
    <category term="前端" scheme="https://zml3589110.github.io/categories/%E5%89%8D%E7%AB%AF/"/>
    
    
    <category term="VBA" scheme="https://zml3589110.github.io/tags/VBA/"/>
    
    <category term="窗体" scheme="https://zml3589110.github.io/tags/%E7%AA%97%E4%BD%93/"/>
    
    <category term="图片" scheme="https://zml3589110.github.io/tags/%E5%9B%BE%E7%89%87/"/>
    
  </entry>
  
  <entry>
    <title>VBA命令按钮设置为透明</title>
    <link href="https://zml3589110.github.io/posts/2992967553.html"/>
    <id>https://zml3589110.github.io/posts/2992967553.html</id>
    <published>2022-07-23T02:52:20.000Z</published>
    <updated>2022-07-23T03:10:40.561Z</updated>
    
    <content type="html"><![CDATA[<h1 id="BackStyle-属性"><a href="#BackStyle-属性" class="headerlink" title="BackStyle 属性"></a>BackStyle 属性</h1><blockquote><p>使用 BackStyle 属性可以指定控件是否透明。Byte 型，可读写。<br>expression.BackStyle<br>expression     必需。返回“应用于”列表中的一个对象的表达式。</p></blockquote><ul><li>BackStyle 属性使用下列设置：</li></ul><table><thead><tr><th><strong>设置</strong></th><th><strong>Visual Basic</strong></th><th><strong>说明</strong></th></tr></thead><tbody><tr><td>普通</td><td>1</td><td>（除了<a href="http://www.office-cn.net/t/acvba/html_acprobackstyle.htm">选项组</a>之外，其余控件都默认为该设置）。控件内部的颜色由 <a href="http://www.office-cn.net/t/acvba/html_acprobackcolor.htm">BackColor</a> 属性决定。</td></tr><tr><td>透明</td><td>0</td><td>（选项组的默认设置）。控件是透明的，控件后面的窗体或报表颜色可见。</td></tr></tbody></table><h1 id="设置方法"><a href="#设置方法" class="headerlink" title="设置方法"></a>设置方法</h1><ul><li>命令按钮不像Label，IMage那样可以简单的设置为透明的属性的，Label，Image这样的控件再做的时候都提供了Backstyle这个属性设置，从而可以很简单的修改它们的透明性质，但是Button这样的命令按钮却没有提供，</li></ul><p><strong>因此想设计一个透明的命令按钮常用的有三种做法:</strong></p><ul><li>1.用标签Label来替代命令按钮来执行命令功能，把它设置为透明的即可，但这种方法的缺点是label是平面的，不好看;</li><li>2.用Image来替代命令按钮来执行命令功能，用它是非常灵活的，效果极好，最常用，因为它本身有个Backstyle属性，从而可以将它设置为透明的，另外做一个或者找一个漂亮的图片加在里边就行了，图片是什么效果的做出来的按钮就是什么效果的;</li><li>3.第3种就有些复杂，不常用，且比较难，就是继承VB提供的按钮，然后自己再他的基础上给你编写Backstyle的属性，也就是做一个控件了，这个实用性就很低了，不过有时间可以试着做一下。</li></ul><h1 id="相关链接"><a href="#相关链接" class="headerlink" title="相关链接"></a>相关链接</h1><ol><li><a href="http://www.office-cn.net/t/acvba/html_acprobackstyle.htm">BackStyle 属性</a></li><li><a href="https://zhidao.baidu.com/question/544324686.html">VB中的命令按钮怎么设置为透明的？</a></li></ol><hr><center><font color="red">=================我是分割线=================</font></center><p><strong>欢迎到公众号来唠嗑:</strong></p><img src="https://pic4.zhimg.com/80/v2-eedc5dc7d30beedf4c2f1812df8e61a7_720w.jpg">]]></content>
    
    
    <summary type="html">将VBA命令按钮设置为透明</summary>
    
    
    
    <category term="编程类" scheme="https://zml3589110.github.io/categories/%E7%BC%96%E7%A8%8B%E7%B1%BB/"/>
    
    <category term="VBA" scheme="https://zml3589110.github.io/categories/%E7%BC%96%E7%A8%8B%E7%B1%BB/VBA/"/>
    
    <category term="前端" scheme="https://zml3589110.github.io/categories/%E5%89%8D%E7%AB%AF/"/>
    
    
    <category term="VBA" scheme="https://zml3589110.github.io/tags/VBA/"/>
    
    <category term="命令按钮" scheme="https://zml3589110.github.io/tags/%E5%91%BD%E4%BB%A4%E6%8C%89%E9%92%AE/"/>
    
    <category term="透明" scheme="https://zml3589110.github.io/tags/%E9%80%8F%E6%98%8E/"/>
    
  </entry>
  
  <entry>
    <title>SQL语句之一(WHERE条件查询)</title>
    <link href="https://zml3589110.github.io/posts/3624342376.html"/>
    <id>https://zml3589110.github.io/posts/3624342376.html</id>
    <published>2022-07-23T02:12:20.000Z</published>
    <updated>2022-07-23T02:47:39.144Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>SQL WHERE是SQL的条件查询语句。SQL查询里的条件指定了要返回满足什么标准的信息。条件的值是TRUE或FALSE，从而限制查询中获取的数据。WHERE子句用于给查询添加条件，从而去除用户不需要的数据。WHERE自己本身比较简单，本文更多地介绍WHERE子句与比较运算符、逻辑运算符和通配符这三种方式对检索条件进行过滤。<br>WHERE子句里可以有多个条件，它们之间以操作符 AND 或 OR 连接。</p></blockquote><h1 id="SQL-WHERE-语法"><a href="#SQL-WHERE-语法" class="headerlink" title="SQL WHERE 语法"></a>SQL WHERE 语法</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> column_name,column_name</span><br><span class="line"><span class="keyword">FROM</span> table_name</span><br><span class="line"><span class="keyword">WHERE</span> column_name operator <span class="keyword">value</span>;</span><br></pre></td></tr></table></figure><h1 id="SQL-WHERE-子句比较运算符"><a href="#SQL-WHERE-子句比较运算符" class="headerlink" title="SQL WHERE 子句比较运算符"></a>SQL WHERE 子句比较运算符</h1><blockquote><p><strong>在SQL中，我们可以使用WHERE子句对条件进行筛选，在此之前，你需要了解WHERE子句中的比较运算符。这些比较运算符的含义你可以参见下面这张表格：</strong></p></blockquote><p>|   含义   |  运算符    |<br>| :–: | :–: |<br>|  等于    |   &#x3D;   |<br>|   不等于   |  &lt;&gt;或!&#x3D;    |<br>|   小于   |   &lt;   |<br>|   小于等于（不大于）   |   &lt;&#x3D;或者!&gt;   |<br>|   大于   |  &gt;    |<br>|   大于等于（不小于）   |  &gt;&#x3D;或者!&lt;    |<br>|   不小于   |  !&lt;    |<br>|   在指定的两个数值之间   |   BETWEEN   |<br>|    为空值  |   IS NULL   |</p><ul><li>实际上你能看到，同样的含义可能会有多种表达方式，比如小于等于，可以是（&lt;&#x3D;），也可以是不大于（!&gt;）。同样不等于，可以用（&lt;&gt;），也可以用（!&#x3D;），它们的含义都是相同的，但这些符号的顺序都不能颠倒，比如你不能写（&#x3D;&lt;）。</li></ul><blockquote><p><strong>需要注意的是，你需要查看使用的DBMS是否支持，不同的DBMS支持的运算符可能是不同的，比如Access不支持（!&#x3D;），不等于应该使用（&lt;&gt;）。在MySQL中，不支持（!&gt;）（!&lt;）等。</strong></p></blockquote><h2 id="使用示例"><a href="#使用示例" class="headerlink" title="使用示例"></a>使用示例</h2><ul><li>极客教程在<a href="https://geek-docs.com/sql/sql-tutorials/sql-select.html">SQL 查询</a>文章中使用了<a href="https://github.com/eyeandroid/sql_heros_data">heros数据表</a>，我们还是以这张表格做练习。下面我们通过比较运算符对王者荣耀的英雄属性进行条件筛选。</li></ul><blockquote><p>WHERE子句的基本格式是：SELECT ……(列名) FROM ……(表名) WHERE ……(子句条件)</p></blockquote><ol><li>比如我们想要查询所有最大生命值大于6000的英雄：<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> name, hp_max <span class="keyword">FROM</span> heros <span class="keyword">WHERE</span> hp_max <span class="operator">&gt;</span> <span class="number">6000</span></span><br></pre></td></tr></table></figure></li></ol><ul><li>运行结果：（41条记录）</li></ul><img src="https://img.geek-docs.com/sql/tutorials/sql-select-where-02.png"><ol start="2"><li>想要查询所有最大生命值在5399到6811之间的英雄：<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> name, hp_max <span class="keyword">FROM</span> heros <span class="keyword">WHERE</span> hp_max <span class="keyword">BETWEEN</span> <span class="number">5399</span> <span class="keyword">AND</span> <span class="number">6811</span></span><br></pre></td></tr></table></figure></li></ol><ul><li>运行结果：（41条记录）</li></ul><img src="https://img.geek-docs.com/sql/tutorials/sql-select-where-03.png"><blockquote><p><strong>需要注意的是hp_max可以取值到最小值和最大值，即5399和6811。</strong></p></blockquote><ol start="3"><li>我们也可以对heros表中的hp_max字段进行空值检查。<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> name, hp_max <span class="keyword">FROM</span> heros <span class="keyword">WHERE</span> hp_max <span class="keyword">IS</span> <span class="keyword">NULL</span></span><br></pre></td></tr></table></figure></li></ol><ul><li>运行结果为空，说明heros表中的hp_max字段没有存在空值的数据行。</li></ul><h1 id="SQL-WHERE-子句逻辑运算符"><a href="#SQL-WHERE-子句逻辑运算符" class="headerlink" title="SQL WHERE 子句逻辑运算符"></a>SQL WHERE 子句逻辑运算符</h1><blockquote><p><strong>如果我们存在多个WHERE条件子句，可以使用逻辑运算符：</strong></p></blockquote><p>|   含义   |  逻辑运算符    |<br>| :–: | :–: |<br>|  并且    |   AND   |<br>|   或者   |  OR    |<br>|   在指定条件范围内   |   IN   |<br>|   非（否定）   |  NOT   |</p><h2 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h2><ul><li>我们还是通过例子来看下这些逻辑运算符的使用，同样采用heros这张表的数据查询。</li></ul><ol><li>假设想要筛选最大生命值大于6000，最大法力大于1700的英雄，然后按照最大生命值和最大法力值之和从高到低进行排序。<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> name, hp_max, mp_max <span class="keyword">FROM</span> heros <span class="keyword">WHERE</span> hp_max <span class="operator">&gt;</span> <span class="number">6000</span> <span class="keyword">AND</span> mp_max <span class="operator">&gt;</span> <span class="number">1700</span> <span class="keyword">ORDER</span> <span class="keyword">BY</span> (hp_max<span class="operator">+</span>mp_max) <span class="keyword">DESC</span></span><br></pre></td></tr></table></figure></li></ol><ul><li>运行结果：（23条记录）</li></ul><img src="https://img.geek-docs.com/sql/tutorials/sql-select-where-05.png"><ol start="2"><li>如果AND和OR同时存在WHERE子句中会是怎样的呢？假设我们想要查询最大生命值加最大法力值大于8000的英雄，或者最大生命值大于6000并且最大法力值大于1700的英雄。<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> name, hp_max, mp_max <span class="keyword">FROM</span> heros <span class="keyword">WHERE</span> (hp_max<span class="operator">+</span>mp_max) <span class="operator">&gt;</span> <span class="number">8000</span> <span class="keyword">OR</span> hp_max <span class="operator">&gt;</span> <span class="number">6000</span> <span class="keyword">AND</span> mp_max <span class="operator">&gt;</span> <span class="number">1700</span> <span class="keyword">ORDER</span> <span class="keyword">BY</span> (hp_max<span class="operator">+</span>mp_max) <span class="keyword">DESC</span></span><br></pre></td></tr></table></figure></li></ol><ul><li>运行结果：（33条记录）</li></ul><img src="https://img.geek-docs.com/sql/tutorials/sql-select-where-06.png"><ul><li>你能看出来相比于上一个条件查询，这次的条件查询多出来了10个英雄，这是因为我们放宽了条件，允许最大生命值+最大法力值大于8000的英雄显示出来。</li></ul><blockquote><p><strong>另外你需要注意到，当WHERE子句中同时存在OR和AND的时候，AND执行的优先级会更高，也就是说SQL会优先处理AND操作符，然后再处理OR操作符。</strong></p></blockquote><ol start="3"><li>如果我们对这条查询语句OR两边的条件增加一个括号，结果会是怎样的呢？<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> name, hp_max, mp_max <span class="keyword">FROM</span> heros <span class="keyword">WHERE</span> ((hp_max<span class="operator">+</span>mp_max) <span class="operator">&gt;</span> <span class="number">8000</span> <span class="keyword">OR</span> hp_max <span class="operator">&gt;</span> <span class="number">6000</span>) <span class="keyword">AND</span> mp_max <span class="operator">&gt;</span> <span class="number">1700</span> <span class="keyword">ORDER</span> <span class="keyword">BY</span> (hp_max<span class="operator">+</span>mp_max) <span class="keyword">DESC</span></span><br></pre></td></tr></table></figure></li></ol><ul><li>运行结果：</li></ul><img src="https://img.geek-docs.com/sql/tutorials/sql-select-where-07.png"><blockquote><p><strong>所以当WHERE子句中同时出现AND和OR操作符的时候，你需要考虑到执行的先后顺序，也就是两个操作符执行的优先级。一般来说()优先级最高，其次优先级是AND，然后是OR。</strong></p></blockquote><ol start="4"><li>如果我想要查询主要定位或者次要定位是法师或是射手的英雄，同时英雄的上线时间不在2016-01-01到2017-01-01之间。<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> name, role_main, role_assist, hp_max, mp_max, birthdate</span><br><span class="line"><span class="keyword">FROM</span> heros </span><br><span class="line"><span class="keyword">WHERE</span> (role_main <span class="keyword">IN</span> (<span class="string">&#x27;法师&#x27;</span>, <span class="string">&#x27;射手&#x27;</span>) <span class="keyword">OR</span> role_assist <span class="keyword">IN</span> (<span class="string">&#x27;法师&#x27;</span>, <span class="string">&#x27;射手&#x27;</span>)) </span><br><span class="line"><span class="keyword">AND</span> <span class="type">DATE</span>(birthdate) <span class="keyword">NOT</span> <span class="keyword">BETWEEN</span> <span class="string">&#x27;2016-01-01&#x27;</span> <span class="keyword">AND</span> <span class="string">&#x27;2017-01-01&#x27;</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> (hp_max <span class="operator">+</span> mp_max) <span class="keyword">DESC</span></span><br></pre></td></tr></table></figure></li></ol><blockquote><p>你能看到我把WHERE子句分成了两个部分。第一部分是关于主要定位和次要定位的条件过滤，使用的是role_main in (‘法师’, ‘射手’) OR role_assist in (‘法师’, ‘射手’)。这里用到了IN逻辑运算符，同时role_main和role_assist是OR（或）的关系。</p></blockquote><ul><li><p>第二部分是关于上线时间的条件过滤。NOT代表否，因为我们要找到不在2016-01-01到2017-01-01之间的日期，因此用到了NOT BETWEEN ‘2016-01-01’ AND ‘2017-01-01’。同时我们是在对日期类型数据进行检索，所以使用到了DATE函数，将字段birthdate转化为日期类型再进行比较。关于日期的操作，可以参考极客教程提供的。</p></li><li><p>这是运行结果（6条记录）：</p></li></ul><img src="https://img.geek-docs.com/sql/tutorials/sql-select-where-08.png"><h1 id="SQL-WHERE-子句使用通配符进行过滤"><a href="#SQL-WHERE-子句使用通配符进行过滤" class="headerlink" title="SQL WHERE 子句使用通配符进行过滤"></a>SQL WHERE 子句使用通配符进行过滤</h1><blockquote><p>刚才讲解的条件过滤都是对已知值进行的过滤，还有一种情况是我们要检索文本中包含某个词的所有数据，这里就需要使用通配符。通配符就是我们用来匹配值的一部分的特殊字符。这里我们需要使用到LIKE操作符。</p></blockquote><ol><li>如果我们想要匹配任意字符串出现的任意次数，需要使用（%）通配符。比如我们想要查找英雄名中包含“太”字的英雄都有哪些：<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> name <span class="keyword">FROM</span> heros <span class="keyword">WHERE</span> name <span class="keyword">LIKE</span> <span class="string">&#x27;%太%&#x27;</span></span><br></pre></td></tr></table></figure></li></ol><ul><li>运行结果：（2条记录）</li></ul><img src="https://img.geek-docs.com/sql/tutorials/sql-select-where-09.png"><blockquote><p><strong>需要说明的是不同DBMS对通配符的定义不同，在Access中使用的是（*）而不是（%）。另外关于字符串的搜索可能是需要区分大小写的，比如’liu%’就不能匹配上’LIU BEI’。具体是否区分大小写还需要考虑不同的DBMS以及它们的配置。</strong></p></blockquote><ol start="2"><li>如果我们想要匹配单个字符，就需要使用下划线(_)通配符。（%）和（_）的区别在于</li></ol><ul><li>（<code>%</code>）代表一个或多个字符</li><li>（<code>_</code>）只代表一个字符</li></ul><p>比如我们想要查找英雄名除了第一个字以外，包含“太”字的英雄有哪些。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> name <span class="keyword">FROM</span> heros <span class="keyword">WHERE</span> name <span class="keyword">LIKE</span> <span class="string">&#x27;_%太%&#x27;</span></span><br></pre></td></tr></table></figure><ul><li>运行结果（1条记录）：</li></ul><p><img src="https://img.geek-docs.com/sql/tutorials/sql-select-where-10.png" alt="SQL WHERE 条件查询"></p><blockquote><p>因为太乙真人的太是第一个字符，而_%太%中的太不是在第一个字符，所以匹配不到“太乙真人”，只可以匹配上“东皇太一”。</p></blockquote><ul><li>同样需要说明的是，在Access中使用（<code>?</code>）来代替（<code>_</code>），而且在DB2中是不支持通配符（<code>_</code>）的，因此你需要在使用的时候查阅相关的DBMS文档。</li></ul><blockquote><p>你能看出来通配符还是很有用的，尤其是在进行字符串匹配的时候。不过在实际操作过程中，我还是建议你尽量少用通配符，因为它需要消耗数据库更长的时间来进行匹配。即使你对LIKE检索的字段进行了索引，索引的价值也可能会失效。如果要让索引生效，那么LIKE后面就不能以（<code>%</code>）开头，比如使用<code>LIKE &#39;%太%&#39;</code>或<code>LIKE &#39;%太&#39;</code>的时候就会对全表进行扫描。如果使用<code>LIKE &#39;太%&#39;</code>，同时检索的字段进行了索引的时候，则不会进行全表扫描。</p></blockquote><hr><h1 id="相关链接"><a href="#相关链接" class="headerlink" title="相关链接"></a>相关链接</h1><ol><li><a href="https://geek-docs.com/sql/sql-tutorials/sql-select-where.html">SQL WHERE 条件查询（极客教程）</a></li></ol><hr><center><font color="red">=================我是分割线=================</font></center><p><strong>欢迎到公众号来唠嗑:</strong></p><img src="https://pic4.zhimg.com/80/v2-eedc5dc7d30beedf4c2f1812df8e61a7_720w.jpg">]]></content>
    
    
    <summary type="html">SQL语句之条件 WHERE 查询，指定了要返回满足什么标准的信息</summary>
    
    
    
    <category term="编程来" scheme="https://zml3589110.github.io/categories/%E7%BC%96%E7%A8%8B%E6%9D%A5/"/>
    
    <category term="数据库" scheme="https://zml3589110.github.io/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
    
    <category term="数据库" scheme="https://zml3589110.github.io/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
    <category term="mysql" scheme="https://zml3589110.github.io/tags/mysql/"/>
    
    <category term="WHERE" scheme="https://zml3589110.github.io/tags/WHERE/"/>
    
    <category term="条件查询" scheme="https://zml3589110.github.io/tags/%E6%9D%A1%E4%BB%B6%E6%9F%A5%E8%AF%A2/"/>
    
  </entry>
  
  <entry>
    <title>VBA数据处理之二(日期处理)</title>
    <link href="https://zml3589110.github.io/posts/2278476872.html"/>
    <id>https://zml3589110.github.io/posts/2278476872.html</id>
    <published>2022-07-23T01:10:20.000Z</published>
    <updated>2022-07-23T02:06:27.218Z</updated>
    
    <content type="html"><![CDATA[<h1 id="日期基本处理"><a href="#日期基本处理" class="headerlink" title="日期基本处理"></a>日期基本处理</h1><h2 id="定义一个日期"><a href="#定义一个日期" class="headerlink" title="定义一个日期"></a>定义一个日期</h2><figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">v_date = <span class="type">Date</span>  <span class="comment">&#x27; 今天，格式为：yyyy-MM-dd</span></span><br><span class="line">v_time = Now   <span class="comment">&#x27; 此时，格式为：yyyy-MM-dd HH:mm:ss</span></span><br><span class="line">v_date2 = #<span class="string">&quot;2021-06-01&quot;</span> <span class="comment">&#x27;指定时间</span></span><br><span class="line">v_date3 = <span class="built_in">CDate</span>(<span class="string">&quot;2021-06-01&quot;</span>)</span><br></pre></td></tr></table></figure><h2 id="日期格式化"><a href="#日期格式化" class="headerlink" title="日期格式化"></a>日期格式化</h2><figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&#x27; 2022-01-28</span></span><br><span class="line">Format(<span class="type">Date</span>, <span class="string">&quot;yyyy-MM-dd&quot;</span>)</span><br><span class="line"><span class="comment">&#x27; 获取当天的年周数，格式为长格式，例如第一周显示为01</span></span><br><span class="line">v_week_num = WorksheetFunction.WeekNum(<span class="type">Date</span>, vbMonday)</span><br><span class="line">Format(v_week_num, <span class="string">&quot;00&quot;</span>)</span><br></pre></td></tr></table></figure><h2 id="日期处理"><a href="#日期处理" class="headerlink" title="日期处理"></a>日期处理</h2><ul><li>对日期进行处理，得到想要的目标日期</li></ul><figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&#x27; 今天</span></span><br><span class="line">today = <span class="type">Date</span></span><br><span class="line"><span class="comment">&#x27; 昨天</span></span><br><span class="line">yesterday = today - <span class="number">1</span></span><br><span class="line"><span class="comment">&#x27; 本周一 注：在Excel中，周日是一周的第一天</span></span><br><span class="line">monday = today - Weekday(today) + <span class="number">2</span></span><br><span class="line"><span class="comment">&#x27; 本月第一天</span></span><br><span class="line">monthFirstDay = lastMonday - Day(lastMonday) + <span class="number">1</span></span><br><span class="line"><span class="comment">&#x27; 本月最后一天</span></span><br><span class="line">targetDate = DateSerial(Year(targetDate), Month(targetDate) + <span class="number">1</span>, <span class="number">0</span>)</span><br><span class="line"><span class="comment">&#x27; 今天是一年的第几周，以周一作为本周的第一天</span></span><br><span class="line">weekNum = WorksheetFunction.weekNum(today, vbMonday)</span><br></pre></td></tr></table></figure><h2 id="日期比较"><a href="#日期比较" class="headerlink" title="日期比较"></a>日期比较</h2><ul><li>日期是可以直接比较和相减的，相减的间隔为时间的间隔。</li></ul><figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&#x27; 今天</span></span><br><span class="line">today = <span class="type">Date</span></span><br><span class="line"><span class="comment">&#x27; 昨天</span></span><br><span class="line">yesterday = today - <span class="number">1</span></span><br><span class="line"><span class="comment">&#x27; 日期之间也可以比较和加减</span></span><br><span class="line">today &gt; yesterday  <span class="comment">&#x27; True</span></span><br><span class="line">today - yesterday  <span class="comment">&#x27; 1 ，相隔1一天</span></span><br></pre></td></tr></table></figure><h2 id="计算时间间隔"><a href="#计算时间间隔" class="headerlink" title="计算时间间隔"></a>计算时间间隔</h2><ul><li>DateDiff 函数可以用于计算时间的间隔。</li></ul><figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> tt1()</span><br><span class="line">    <span class="keyword">Dim</span> d1, d2 <span class="keyword">As</span> <span class="type">Date</span></span><br><span class="line">    d1 = <span class="literal">#11/21/2021#</span></span><br><span class="line">    d2 = <span class="literal">#12/1/2022#</span></span><br><span class="line">    MsgBox(<span class="string">&quot;相隔&quot;</span> &amp; (d2 - d1) &amp; <span class="string">&quot;天&quot;</span>)</span><br><span class="line">    MsgBox(<span class="string">&quot;相隔&quot;</span> &amp; DateDiff(<span class="string">&quot;d&quot;</span>, d1, d2) &amp; <span class="string">&quot;天&quot;</span>)</span><br><span class="line">    MsgBox(<span class="string">&quot;相隔&quot;</span> &amp; DateDiff(<span class="string">&quot;m&quot;</span>, d1, d2) &amp; <span class="string">&quot;月&quot;</span>)</span><br><span class="line">    MsgBox(<span class="string">&quot;相隔&quot;</span> &amp; DateDiff(<span class="string">&quot;yyyy&quot;</span>, d1, d2) &amp; <span class="string">&quot;年&quot;</span>)</span><br><span class="line">    MsgBox(<span class="string">&quot;相隔&quot;</span> &amp; DateDiff(<span class="string">&quot;q&quot;</span>, d1, d2) &amp; <span class="string">&quot;季&quot;</span>)</span><br><span class="line">    MsgBox(<span class="string">&quot;相隔&quot;</span> &amp; DateDiff(<span class="string">&quot;w&quot;</span>, d1, d2) &amp; <span class="string">&quot;周&quot;</span>)</span><br><span class="line">    MsgBox(<span class="string">&quot;相隔&quot;</span> &amp; DateDiff(<span class="string">&quot;h&quot;</span>, d1, d2) &amp; <span class="string">&quot;小时&quot;</span>)</span><br><span class="line">    MsgBox(<span class="string">&quot;相隔&quot;</span> &amp; DateDiff(<span class="string">&quot;n&quot;</span>, d1, d2) &amp; <span class="string">&quot;分种&quot;</span>)</span><br><span class="line">    MsgBox(<span class="string">&quot;相隔&quot;</span> &amp; DateDiff(<span class="string">&quot;s&quot;</span>, d1, d2) &amp; <span class="string">&quot;秒&quot;</span>)</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure><h2 id="计算耗时"><a href="#计算耗时" class="headerlink" title="计算耗时"></a>计算耗时</h2><figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">startTime = Time</span><br><span class="line"></span><br><span class="line"><span class="comment">&#x27; 业务数据处理</span></span><br><span class="line">MsgBox (<span class="string">&quot;运行此流程共耗时：&quot;</span> &amp; DateDiff(<span class="string">&quot;s&quot;</span>, startTime, Time) &amp; <span class="string">&quot;秒&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">&#x27; 后台打印使用的时间</span></span><br><span class="line">Debug.Print DateDiff(<span class="string">&quot;s&quot;</span>, startTime, Time) &amp; <span class="string">&quot;秒&quot;</span></span><br></pre></td></tr></table></figure><h1 id="vba日期和时间函数汇总和代码"><a href="#vba日期和时间函数汇总和代码" class="headerlink" title="vba日期和时间函数汇总和代码"></a>vba日期和时间函数汇总和代码</h1><h2 id="第一，vba日期和时间函数的基本用法"><a href="#第一，vba日期和时间函数的基本用法" class="headerlink" title="第一，vba日期和时间函数的基本用法"></a>第一，vba日期和时间函数的基本用法</h2><blockquote><p>Excel中vba日期函数和时间函数分别是DATE和TIME。<br>VBA提供了三个无参数函数：Date、Time、Now，分别返回当前电脑系统的日期、时间、日期+时间。<br>下面的代码我们以三个消息框来结合日期和时间函数，分别提示当前的日期、时间。</p></blockquote><figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> vba时间和日期函数()</span><br><span class="line">    MsgBox <span class="type">Date</span></span><br><span class="line">    MsgBox Time</span><br><span class="line">    MsgBox Now</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure><h2 id="第二，使用vba日期和时间函数修改系统信息"><a href="#第二，使用vba日期和时间函数修改系统信息" class="headerlink" title="第二，使用vba日期和时间函数修改系统信息"></a>第二，使用vba日期和时间函数修改系统信息</h2><ul><li>下面这段代码将电脑右下角的日期和时间修改为2011年1月1日21:50:00。<figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> 修改时间和日期()</span><br><span class="line">  Time = <span class="string">&quot;21:50:00&quot;</span></span><br><span class="line">  <span class="type">Date</span> = <span class="string">&quot;2011年1月1日&quot;</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure></li></ul><h2 id="第三，用消息框返回当前日期的年、月、日和当前时间的时、分、秒"><a href="#第三，用消息框返回当前日期的年、月、日和当前时间的时、分、秒" class="headerlink" title="第三，用消息框返回当前日期的年、月、日和当前时间的时、分、秒"></a>第三，用消息框返回当前日期的年、月、日和当前时间的时、分、秒</h2><figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> SmpYearHour()</span><br><span class="line">    <span class="comment">&#x27;以对话框显示当前日期的年、月、日</span></span><br><span class="line">    MsgBox <span class="string">&quot;当前日期：&quot;</span> &amp; <span class="type">Date</span> &amp; Chr(<span class="number">10</span>) &amp; _</span><br><span class="line">           <span class="string">&quot;年：&quot;</span> &amp; Year(<span class="type">Date</span>) &amp; Chr(<span class="number">10</span>) &amp; _</span><br><span class="line">           <span class="string">&quot;月：&quot;</span> &amp; Month(<span class="type">Date</span>) &amp; Chr(<span class="number">10</span>) &amp; _</span><br><span class="line">           <span class="string">&quot;日：&quot;</span> &amp; Day(<span class="type">Date</span>)</span><br><span class="line">    <span class="comment">&#x27;以对话框显示当前时间的时、分、秒</span></span><br><span class="line">    MsgBox <span class="string">&quot;当前时间：&quot;</span> &amp; Time &amp; Chr(<span class="number">10</span>) &amp; _</span><br><span class="line">           <span class="string">&quot;时：&quot;</span> &amp; Hour(Time) &amp; Chr(<span class="number">10</span>) &amp; _</span><br><span class="line">           <span class="string">&quot;分：&quot;</span> &amp; Minute(Time) &amp; Chr(<span class="number">10</span>) &amp; _</span><br><span class="line">           <span class="string">&quot;秒：&quot;</span> &amp; Second(Time)</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure><h2 id="第四，其余的vba日期和时间函数列表"><a href="#第四，其余的vba日期和时间函数列表" class="headerlink" title="第四，其余的vba日期和时间函数列表"></a>第四，其余的vba日期和时间函数列表</h2><p>| 函数  |  说明 |<br>| —- | —- |<br>| Timer | 返回一个 Single，代表从午夜开始到现在经过的秒数。     |<br>| TimeSerial(hour, minute, second) | 返回一个 Variant (Date)，包含具有具体时、分、秒的时间。     |<br>| DateDiff(interval, date1, date2[, firstdayofweek[, firstweekofyear]]) | 返回 Variant (Long) 的值，表示两个指定日期间的时间间隔数目。     |<br>| Second(time) | 返回一个 Variant (Integer)，其值为 0 到 59 之间的整数，表示一分钟之中的某个秒。     |<br>| Minute(time) | 返回一个 Variant (Integer)，其值为 0 到 59 之间的整数，表示一小时中的某分钟。     |<br>| Hour(time) | 返回一个 Variant (Integer)，其值为 0 到 23 之间的整数，表示一天之中的某一钟点。     |<br>| Day(date) | 返回一个 Variant (Integer)，其值为 1 到 31 之间的整数，表示一个月中的某一日。     |<br>| Month(date) |  返回一个 Variant (Integer)，其值为 1 到 12 之间的整数，表示一年中的某月。    |<br>| Year(date) |  返回 Variant (Integer)，包含表示年份的整数。    |<br>| Weekday(date, [firstdayofweek]) |  返回一个 Variant (Integer)，包含一个整数，代表某个日期是星期几    |</p><hr><h1 id="相关链接"><a href="#相关链接" class="headerlink" title="相关链接"></a>相关链接</h1><ol><li><a href="https://blog.csdn.net/m1090760001/article/details/122464601">VBA实战(10) - 日期处理汇总</a></li><li><a href="https://blog.csdn.net/w57w57w57/article/details/43772081">vba日期和时间函数汇总和代码</a></li></ol><hr><center><font color="red">=================我是分割线=================</font></center><p><strong>欢迎到公众号来唠嗑:</strong></p><img src="https://pic4.zhimg.com/80/v2-eedc5dc7d30beedf4c2f1812df8e61a7_720w.jpg">]]></content>
    
    
    <summary type="html">VBA数据处理之二:日期处理汇总</summary>
    
    
    
    <category term="编程类" scheme="https://zml3589110.github.io/categories/%E7%BC%96%E7%A8%8B%E7%B1%BB/"/>
    
    <category term="VBA" scheme="https://zml3589110.github.io/categories/%E7%BC%96%E7%A8%8B%E7%B1%BB/VBA/"/>
    
    <category term="前端" scheme="https://zml3589110.github.io/categories/%E5%89%8D%E7%AB%AF/"/>
    
    
    <category term="VBA" scheme="https://zml3589110.github.io/tags/VBA/"/>
    
    <category term="数据处理" scheme="https://zml3589110.github.io/tags/%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86/"/>
    
    <category term="日期处理" scheme="https://zml3589110.github.io/tags/%E6%97%A5%E6%9C%9F%E5%A4%84%E7%90%86/"/>
    
  </entry>
  
  <entry>
    <title>VBA字符串</title>
    <link href="https://zml3589110.github.io/posts/1296505440.html"/>
    <id>https://zml3589110.github.io/posts/1296505440.html</id>
    <published>2022-06-28T07:18:20.000Z</published>
    <updated>2022-06-28T07:26:49.972Z</updated>
    
    <content type="html"><![CDATA[<ul><li>字符串是一个字符序列，可以由字母，数字，特殊字符或全部字符组成。 如果一个变量被包含在双引号””中，则被认为是一个字符串。</li></ul><p><strong>语法：</strong></p><figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">variable_name = <span class="string">&quot;this is a string&quot;</span></span><br></pre></td></tr></table></figure><p><strong>简单示例：</strong></p><figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">str1 = <span class="string">&quot;string&quot;</span>   <span class="comment">&#x27; Only Alphabets</span></span><br><span class="line">str2 = <span class="string">&quot;132.45&quot;</span>   <span class="comment">&#x27; Only Numbers</span></span><br><span class="line">str3 = <span class="string">&quot;!@#$;*&quot;</span>  <span class="comment">&#x27; Only Special Characters</span></span><br><span class="line">Str4 = <span class="string">&quot;Asc23@#&quot;</span>  <span class="comment">&#x27; Has all the above</span></span><br></pre></td></tr></table></figure><p><strong>字符串函数:</strong></p><p>预定义的VBA字符串函数可以帮助开发人员非常有效地处理字符串。以下是VBA中支持的字符串的方法。请点击每个方法来详细了解。</p><table><thead><tr><th>编号</th><th>函数</th><th>描述</th></tr></thead><tbody><tr><td>1</td><td><a href="http://www.yiibai.com/vba/vba_instr_function.html">InStr</a></td><td>返回指定子字符串的第一个匹配项。从左到右搜索。</td></tr><tr><td>2</td><td><a href="http://www.yiibai.com/vba/vba_instrrev_function.html">InstrRev</a></td><td>返回指定子字符串的第一个匹配项。从右到左搜索。</td></tr><tr><td>3</td><td><a href="http://www.yiibai.com/vba/vba_lcase_function.html">Lcase</a></td><td>返回指定字符串的小写字母。</td></tr><tr><td>4</td><td><a href="http://www.yiibai.com/vba/vba_ucase_function.html">Ucase</a></td><td>返回指定字符串转为大写字母的形式。</td></tr><tr><td>5</td><td><a href="http://www.yiibai.com/vba/vba_left_function.html">Left</a></td><td>返回在左侧指定数量字符的字符串。</td></tr><tr><td>6</td><td><a href="http://www.yiibai.com/vba/vba_right_function.html">Right</a></td><td>返回在右侧指定数量字符的字符串</td></tr><tr><td>7</td><td><a href="http://www.yiibai.com/vba/vba_mid_function.html">Mid</a></td><td>根据指定的参数从字符串中返回特定数量的字符。</td></tr><tr><td>8</td><td><a href="http://www.yiibai.com/vba/vba_ltrim_function.html">Ltrim</a></td><td>删除指定字符串左侧的空格后返回一个字符串。</td></tr><tr><td>9</td><td><a href="http://www.yiibai.com/vba/vba_rtrim_function.html">Rtrim</a></td><td>删除指定字符串右侧的空格后返回一个字符串。</td></tr><tr><td>10</td><td><a href="http://www.yiibai.com/vba/vba_trim_function.html">Trim</a></td><td>删除开头和结尾空格后返回一个字符串值。</td></tr><tr><td>11</td><td><a href="http://www.yiibai.com/vba/vba_len_function.html">Len</a></td><td>返回给定字符串的长度。</td></tr><tr><td>12</td><td><a href="http://www.yiibai.com/vba/vba_replace_function.html">Replace</a></td><td>用另一个字符串替换字符串后返回字符串。</td></tr><tr><td>13</td><td><a href="http://www.yiibai.com/vba/vba_space_function.html">Space</a></td><td>用指定数量的空格填充字符串。</td></tr><tr><td>14</td><td><a href="http://www.yiibai.com/vba/vba_strcomp_function.html">StrComp</a></td><td>比较两个指定的字符串后返回一个整数值。</td></tr><tr><td>15</td><td><a href="http://www.yiibai.com/vba/vba_string_function.html">String</a></td><td>返回指定次数的字符的字符串。</td></tr><tr><td>16</td><td><a href="http://www.yiibai.com/vba/vba_strreverse_function.html">StrReverse</a></td><td>反转给定字符串的字符序列后，返回一个字符串。</td></tr></tbody></table><hr><h1 id="相关链接"><a href="#相关链接" class="headerlink" title="相关链接"></a>相关链接</h1><ol><li><a href="https://www.yiibai.com/vba/vba_strings.html">VBA字符串)</a></li><li><a href="https://www.yiibai.com/vba">VBA教程</a></li></ol><hr><center><font color="red">=================我是分割线=================</font></center><p><strong>欢迎到公众号来唠嗑:</strong></p><img src="https://pic4.zhimg.com/80/v2-eedc5dc7d30beedf4c2f1812df8e61a7_720w.jpg">]]></content>
    
    
    <summary type="html">字符串相关函数收集</summary>
    
    
    
    <category term="编程类" scheme="https://zml3589110.github.io/categories/%E7%BC%96%E7%A8%8B%E7%B1%BB/"/>
    
    <category term="VBA" scheme="https://zml3589110.github.io/categories/%E7%BC%96%E7%A8%8B%E7%B1%BB/VBA/"/>
    
    <category term="前端" scheme="https://zml3589110.github.io/categories/%E5%89%8D%E7%AB%AF/"/>
    
    
    <category term="VBA" scheme="https://zml3589110.github.io/tags/VBA/"/>
    
    <category term="数据处理" scheme="https://zml3589110.github.io/tags/%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86/"/>
    
    <category term="字符串" scheme="https://zml3589110.github.io/tags/%E5%AD%97%E7%AC%A6%E4%B8%B2/"/>
    
  </entry>
  
  <entry>
    <title>VBA数据处理之一(字符串)</title>
    <link href="https://zml3589110.github.io/posts/3177018411.html"/>
    <id>https://zml3589110.github.io/posts/3177018411.html</id>
    <published>2022-06-28T07:09:20.000Z</published>
    <updated>2022-06-28T07:26:49.941Z</updated>
    
    <content type="html"><![CDATA[<p>假设有字符串：“world2q3423j;;3254&lt;sflskjdf”<br>现在要获取每个字符到myChars数组，得到这样的结果：</p><p>myChars(1) &#x3D; w<br>myChars(2) &#x3D; o</p><figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> aaa()</span><br><span class="line"><span class="keyword">Dim</span> myChars()</span><br><span class="line">abc = <span class="string">&quot;world2q3423j;;3254&lt;sflskjdf&quot;</span></span><br><span class="line"><span class="keyword">ReDim</span> myChars(<span class="number">1</span> <span class="keyword">To</span> Len(abc))</span><br><span class="line"><span class="keyword">For</span> n = <span class="number">1</span> <span class="keyword">To</span> Len(abc)</span><br><span class="line">myChars(n) = <span class="keyword">Mid</span>(abc, n, <span class="number">1</span>)</span><br><span class="line">Cells(n, <span class="number">1</span>) = myChars(n)</span><br><span class="line"><span class="keyword">Next</span> n</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure><hr><h1 id="相关链接"><a href="#相关链接" class="headerlink" title="相关链接"></a>相关链接</h1><ol><li><a href="https://zhidao.baidu.com/question/304450382179355164.html">VBA: 如何最好地获取一个字符串里的每个字符？)</a></li></ol><hr><center><font color="red">=================我是分割线=================</font></center><p><strong>欢迎到公众号来唠嗑:</strong></p><img src="https://pic4.zhimg.com/80/v2-eedc5dc7d30beedf4c2f1812df8e61a7_720w.jpg">]]></content>
    
    
    <summary type="html">VBA数据处理之一(字符串)</summary>
    
    
    
    <category term="编程类" scheme="https://zml3589110.github.io/categories/%E7%BC%96%E7%A8%8B%E7%B1%BB/"/>
    
    <category term="VBA" scheme="https://zml3589110.github.io/categories/%E7%BC%96%E7%A8%8B%E7%B1%BB/VBA/"/>
    
    <category term="前端" scheme="https://zml3589110.github.io/categories/%E5%89%8D%E7%AB%AF/"/>
    
    
    <category term="VBA" scheme="https://zml3589110.github.io/tags/VBA/"/>
    
    <category term="数据处理" scheme="https://zml3589110.github.io/tags/%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86/"/>
    
    <category term="字符串" scheme="https://zml3589110.github.io/tags/%E5%AD%97%E7%AC%A6%E4%B8%B2/"/>
    
  </entry>
  
  <entry>
    <title>VBA窗体使用图片</title>
    <link href="https://zml3589110.github.io/posts/2635706068.html"/>
    <id>https://zml3589110.github.io/posts/2635706068.html</id>
    <published>2022-06-28T07:06:20.000Z</published>
    <updated>2022-06-28T07:26:49.972Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p><strong>今天学习了一个窗体image控件，发现可以实现客户资料的加载显示功能，目前学到的一个是加载(.jpg)格式类图片，具体我想可以在文件夹中加载一些客户产品图片、客户营业执照、员工照片等强调可视化内容的资料。</strong></p></blockquote><ul><li>显示效果如图：</li></ul><img src="https://pics1.baidu.com/feed/810a19d8bc3eb135a0c6a2ca40babddbfc1f44ee.png?token=af0e2983d672fca858973fc571d10818&s=0020DD1417664F0DC875F850030040F9"><p><strong>代码很简单，只有一句话:</strong></p><figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Private</span> <span class="keyword">Sub</span> TextBox1_Change()</span><br><span class="line"></span><br><span class="line"><span class="keyword">On</span> <span class="keyword">Error</span> <span class="keyword">Resume</span> <span class="keyword">Next</span></span><br><span class="line"></span><br><span class="line">Image1.Picture = LoadPicture(ThisWorkbook.Path &amp; <span class="string">&quot;\&quot;</span> &amp; TextBox1.<span class="keyword">Text</span> &amp; <span class="string">&quot;.jpg&quot;</span>)</span><br><span class="line"></span><br><span class="line">Image1.PictureSizeMode = fmPictureSizeModeZoom</span><br><span class="line"></span><br><span class="line"><span class="keyword">Exit</span> <span class="keyword">Sub</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure><hr><h1 id="相关链接"><a href="#相关链接" class="headerlink" title="相关链接"></a>相关链接</h1><ol><li><a href="https://baijiahao.baidu.com/s?id=1692279467271579081&wfr=spider&for=pc">VBA练习七(窗体图片加载)</a></li></ol><hr><center><font color="red">=================我是分割线=================</font></center><p><strong>欢迎到公众号来唠嗑:</strong></p><img src="https://pic4.zhimg.com/80/v2-eedc5dc7d30beedf4c2f1812df8e61a7_720w.jpg">]]></content>
    
    
    <summary type="html">VBA窗体使用图片</summary>
    
    
    
    <category term="编程类" scheme="https://zml3589110.github.io/categories/%E7%BC%96%E7%A8%8B%E7%B1%BB/"/>
    
    <category term="VBA" scheme="https://zml3589110.github.io/categories/%E7%BC%96%E7%A8%8B%E7%B1%BB/VBA/"/>
    
    <category term="前端" scheme="https://zml3589110.github.io/categories/%E5%89%8D%E7%AB%AF/"/>
    
    
    <category term="VBA" scheme="https://zml3589110.github.io/tags/VBA/"/>
    
    <category term="窗体" scheme="https://zml3589110.github.io/tags/%E7%AA%97%E4%BD%93/"/>
    
    <category term="图片" scheme="https://zml3589110.github.io/tags/%E5%9B%BE%E7%89%87/"/>
    
  </entry>
  
  <entry>
    <title>VBA判断活动窗体</title>
    <link href="https://zml3589110.github.io/posts/462997477.html"/>
    <id>https://zml3589110.github.io/posts/462997477.html</id>
    <published>2022-06-28T06:54:20.000Z</published>
    <updated>2022-06-28T07:26:49.972Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p><strong>其他思路：获得活动窗口句柄，进程外用GetForgroundWindow，进程内用GetActiveWindow</strong></p></blockquote><h1 id="方法一"><a href="#方法一" class="headerlink" title="方法一"></a>方法一</h1><figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Function</span> FormIsActive(sName <span class="keyword">As</span> <span class="type">String</span>) <span class="keyword">As</span> <span class="type">Boolean</span></span><br><span class="line"><span class="keyword">Dim</span> i <span class="keyword">As</span> <span class="type">Integer</span></span><br><span class="line">    <span class="keyword">For</span> i = <span class="number">0</span> <span class="keyword">To</span> VBA.UserForms.Count - <span class="number">1</span></span><br><span class="line">        FormIsActive = UserForms(i).Name = sName</span><br><span class="line">        <span class="keyword">If</span> FormIsActive <span class="keyword">Then</span> <span class="keyword">Exit</span> <span class="keyword">Function</span></span><br><span class="line">    <span class="keyword">Next</span> i</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Function</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Sub</span> LoadUserfrom()</span><br><span class="line">    Userform1.Show</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&#x27;测试: 运行LoadUserfrom前是否得到False,而运行LoadUserfrom后是否得到True的结果?</span></span><br><span class="line"><span class="keyword">Sub</span> Test()</span><br><span class="line">    MsgBox FormIsActive(<span class="string">&quot;UserForm1&quot;</span>), <span class="number">64</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure><h1 id="方法二-改进一"><a href="#方法二-改进一" class="headerlink" title="方法二(改进一)"></a>方法二(改进一)</h1><p>Take a look at attached file and play with the three buttons.</p><p>Let me know if you still have question.</p><figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">Option</span> <span class="keyword">Explicit</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Function</span> FormIsActive(sName <span class="keyword">As</span> <span class="type">String</span>) <span class="keyword">As</span> <span class="type">Boolean</span></span><br><span class="line"><span class="keyword">Dim</span> i <span class="keyword">As</span> <span class="type">Integer</span></span><br><span class="line">    <span class="keyword">For</span> i = <span class="number">0</span> <span class="keyword">To</span> UserForms.Count - <span class="number">1</span></span><br><span class="line">        FormIsActive = UserForms(i).Name = sName</span><br><span class="line">        <span class="keyword">If</span> FormIsActive <span class="keyword">Then</span> <span class="keyword">Exit</span> <span class="keyword">Function</span></span><br><span class="line">    <span class="keyword">Next</span> i</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Function</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Sub</span> LoadUserform1()</span><br><span class="line"><span class="keyword">If</span> FormIsActive(<span class="string">&quot;UserForm2&quot;</span>) <span class="keyword">Then</span></span><br><span class="line">    MsgBox <span class="string">&quot;UserForm2 is active so we&#x27;re unloading it NOW!&quot;</span></span><br><span class="line">    Unload UserForm2</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">    UserForm1.Show</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Sub</span> LoadUserform2()</span><br><span class="line">    UserForm2.Show</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Sub</span> Test()</span><br><span class="line"><span class="keyword">If</span> FormIsActive(<span class="string">&quot;UserForm1&quot;</span>) <span class="built_in">And</span> <span class="built_in">Not</span> FormIsActive(<span class="string">&quot;UserForm2&quot;</span>) <span class="keyword">Then</span></span><br><span class="line">    MsgBox <span class="string">&quot;UserForm1 is Active! UserForm2 is not!&quot;</span></span><br><span class="line">   <span class="keyword">ElseIf</span> FormIsActive(<span class="string">&quot;UserForm2&quot;</span>) <span class="built_in">And</span> <span class="built_in">Not</span> FormIsActive(<span class="string">&quot;UserForm1&quot;</span>) <span class="keyword">Then</span></span><br><span class="line">    MsgBox <span class="string">&quot;UserForm2 is Active! UserForm1 is not!&quot;</span></span><br><span class="line">   <span class="keyword">ElseIf</span> FormIsActive(<span class="string">&quot;UserForm2&quot;</span>) <span class="built_in">And</span> FormIsActive(<span class="string">&quot;UserForm1&quot;</span>) <span class="keyword">Then</span></span><br><span class="line">    MsgBox <span class="string">&quot;UserForm1 and UserForm2 are both Active!&quot;</span></span><br><span class="line">   <span class="keyword">Else</span></span><br><span class="line">    MsgBox <span class="string">&quot;No active userform!&quot;</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure><p><a href="http://www.excelpx.com/forum.php?mod=attachment&aid=MjY0MTMwfDE1NDQzZWFhfDE2NTU4MDEwMjV8MHwyOTUxOTY=">UserForm.zip</a></p><h1 id="最后方法"><a href="#最后方法" class="headerlink" title="最后方法"></a>最后方法</h1><blockquote><p>我现在用一个公共变量，就可以知道是否有窗体是活动</p></blockquote><hr><h1 id="相关链接"><a href="#相关链接" class="headerlink" title="相关链接"></a>相关链接</h1><ol><li><a href="http://www.excelpx.com/thread-295196-1-1.html">【求助】怎样判断一个窗体是否在活动状态？</a></li></ol><hr><center><font color="red">=================我是分割线=================</font></center><p><strong>欢迎到公众号来唠嗑:</strong></p><img src="https://pic4.zhimg.com/80/v2-eedc5dc7d30beedf4c2f1812df8e61a7_720w.jpg">]]></content>
    
    
    <summary type="html">VBA判断窗体是否为在活动状态</summary>
    
    
    
    <category term="编程类" scheme="https://zml3589110.github.io/categories/%E7%BC%96%E7%A8%8B%E7%B1%BB/"/>
    
    <category term="VBA" scheme="https://zml3589110.github.io/categories/%E7%BC%96%E7%A8%8B%E7%B1%BB/VBA/"/>
    
    <category term="前端" scheme="https://zml3589110.github.io/categories/%E5%89%8D%E7%AB%AF/"/>
    
    
    <category term="VBA" scheme="https://zml3589110.github.io/tags/VBA/"/>
    
    <category term="窗体活动" scheme="https://zml3589110.github.io/tags/%E7%AA%97%E4%BD%93%E6%B4%BB%E5%8A%A8/"/>
    
  </entry>
  
  <entry>
    <title>VBA实现进度条显示</title>
    <link href="https://zml3589110.github.io/posts/585123975.html"/>
    <id>https://zml3589110.github.io/posts/585123975.html</id>
    <published>2022-06-28T06:32:20.000Z</published>
    <updated>2022-06-28T07:26:49.972Z</updated>
    
    <content type="html"><![CDATA[<h1 id="窗体中的进度条控件"><a href="#窗体中的进度条控件" class="headerlink" title="窗体中的进度条控件"></a>窗体中的进度条控件</h1><blockquote><p>工具箱默认情况下没有进度条控件，需在“工具”-&gt;“附加控件”里面添加Microsoft ProgressBar Control,version 6.0，即可在工具箱里面看到进度条控件。</p></blockquote><ol><li>添加进度条控件</li></ol><img src="https://img-blog.csdn.net/20160323194238114?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center"><ol start="2"><li>创建一个窗体UserForm1，添加一个进度条ProgressBar1和一个标签Label1，即可可以完成VBA进度条设计。</li></ol><ul><li>eg：经常在一个循环运算中用到进度条，此时可以将循环运算在窗体UserForm1里面进行，即可将循环变量嵌入到ProgressBar1里面进行精准进度条设计。</li></ul><figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Private</span> <span class="keyword">Sub</span> UserForm_Activate()</span><br><span class="line"><span class="keyword">Dim</span> n <span class="keyword">As</span> <span class="type">Integer</span></span><br><span class="line">n = <span class="number">3000</span></span><br><span class="line">ProgressBar1.Min = <span class="number">1</span></span><br><span class="line">ProgressBar1.Max = n</span><br><span class="line">Label1.Caption = <span class="string">&quot;0%&quot;</span></span><br><span class="line"><span class="keyword">For</span> n = <span class="number">1</span> <span class="keyword">To</span> <span class="number">3000</span></span><br><span class="line">ProgressBar1.Value = Str(n)</span><br><span class="line">Label1.Caption = Round(n / ProgressBar1.Max, <span class="number">2</span>) * <span class="number">100</span> &amp; <span class="string">&quot;%&quot;</span></span><br><span class="line">DoEvents</span><br><span class="line"><span class="keyword">Next</span> n</span><br><span class="line"><span class="comment">&#x27;Unload UserForm1</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">&lt;img src=<span class="string">&quot;https://img-blog.csdn.net/20160323194829476?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center&quot;</span>&gt;</span><br><span class="line"></span><br><span class="line"># 在 Excel 下边显示进度条</span><br><span class="line"></span><br><span class="line">- vba处理execl数据时，如果数据量比较大时，execl会执行时间较长，并且不容易看出来已执行的进度。</span><br><span class="line">应用execl的进度条，让执行进度更加一目了然。</span><br><span class="line"></span><br><span class="line">&lt;img src=<span class="string">&quot;https://img-blog.csdnimg.cn/0a4482aa87054ba7a8185e3003e937de.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA6I-y5pavRmFjZQ==,size_12,color_FFFFFF,t_70,g_se,x_16&quot;</span>&gt;</span><br><span class="line"></span><br><span class="line">**进度条代码:**</span><br><span class="line"></span><br><span class="line">```vb</span><br><span class="line"><span class="keyword">Function</span> GetProgress(curValue, maxValue)</span><br><span class="line"><span class="keyword">Dim</span> i <span class="keyword">As</span> <span class="type">Single</span>, j <span class="keyword">As</span> <span class="type">Integer</span>, s <span class="keyword">As</span> <span class="type">String</span></span><br><span class="line">i = maxValue / <span class="number">20</span></span><br><span class="line">j = curValue / i</span><br><span class="line"> </span><br><span class="line"><span class="keyword">For</span> m = <span class="number">1</span> <span class="keyword">To</span> j</span><br><span class="line">    s = s &amp; <span class="string">&quot;■&quot;</span></span><br><span class="line"><span class="keyword">Next</span> m</span><br><span class="line"><span class="keyword">For</span> n = <span class="number">1</span> <span class="keyword">To</span> <span class="number">20</span> - j</span><br><span class="line">    s = s &amp; <span class="string">&quot;□&quot;</span></span><br><span class="line"><span class="keyword">Next</span> n</span><br><span class="line">GetProgress = s &amp; FormatNumber(curValue / maxValue * <span class="number">100</span>, <span class="number">2</span>) &amp; <span class="string">&quot;%&quot;</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Function</span></span><br></pre></td></tr></table></figure><blockquote><p>调用代码</p></blockquote><figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Application.StatusBar = GetProgress(i, maxRow)</span><br></pre></td></tr></table></figure><p>参数可以根据业务情况，自行传入。</p><hr><h1 id="相关链接"><a href="#相关链接" class="headerlink" title="相关链接"></a>相关链接</h1><ol><li><a href="https://blog.csdn.net/Gordennizaicunzai/article/details/50965964">VBA进度条</a></li><li><a href="https://blog.csdn.net/m0_60196931/article/details/122339473">VBA 处理数据的进度条实现</a></li></ol><hr><center><font color="red">=================我是分割线=================</font></center><p><strong>欢迎到公众号来唠嗑:</strong></p><img src="https://pic4.zhimg.com/80/v2-eedc5dc7d30beedf4c2f1812df8e61a7_720w.jpg">]]></content>
    
    
    <summary type="html">VBA实现进度条显示，提醒当前进度状态</summary>
    
    
    
    <category term="编程类" scheme="https://zml3589110.github.io/categories/%E7%BC%96%E7%A8%8B%E7%B1%BB/"/>
    
    <category term="VBA" scheme="https://zml3589110.github.io/categories/%E7%BC%96%E7%A8%8B%E7%B1%BB/VBA/"/>
    
    <category term="前端" scheme="https://zml3589110.github.io/categories/%E5%89%8D%E7%AB%AF/"/>
    
    
    <category term="VBA" scheme="https://zml3589110.github.io/tags/VBA/"/>
    
    <category term="控件" scheme="https://zml3589110.github.io/tags/%E6%8E%A7%E4%BB%B6/"/>
    
    <category term="ProgressBar" scheme="https://zml3589110.github.io/tags/ProgressBar/"/>
    
  </entry>
  
  <entry>
    <title>VBA 鼠标浮上命令按钮有文字提示(ControlTipText)</title>
    <link href="https://zml3589110.github.io/posts/3346834382.html"/>
    <id>https://zml3589110.github.io/posts/3346834382.html</id>
    <published>2022-06-28T06:27:20.000Z</published>
    <updated>2022-06-28T07:26:49.956Z</updated>
    
    <content type="html"><![CDATA[<p>eg.假设 某一个按钮控件名为 commandbutton1,想做到 鼠标悬停在该控件上时，显示提示，提示内容为该控件的名称，可以用下列语句<br>commandbutton1.controltiptext &#x3D; “按钮名称为commandbutton1”</p><ul><li>以下来自excel的帮助文件</li></ul><hr><p>ControlTipText 属性<br>指定当用户将鼠标指针放在控件上但未按下时所显示的文本。<br>语法<br>object.ControlTipText [&#x3D; String]<br>ControlTipText 属性的语法有以下几个成分：<br>成分<br>object 必需。一个有效对象。<br>String 可选。当用户将鼠标指针放在控件上时所显示的文本。<br>说明<br>ControlTipText 属性可为用户提供有关当前运行的窗体中某一控件的提示。该属性可在设计时间设定，但仅在运行时间由控件显示。<br>ControlTipText 的默认值为空字符串。此时，该控件将无任何提示。</p><hr><h1 id="相关链接"><a href="#相关链接" class="headerlink" title="相关链接"></a>相关链接</h1><ol><li><a href="https://zhidao.baidu.com/question/2011574656656416308.html">excel VBA 鼠标浮上命令按钮有文字提示</a></li></ol><hr><center><font color="red">=================我是分割线=================</font></center><p><strong>欢迎到公众号来唠嗑:</strong></p><img src="https://pic4.zhimg.com/80/v2-eedc5dc7d30beedf4c2f1812df8e61a7_720w.jpg">]]></content>
    
    
    <summary type="html">当鼠标浮上命令按钮有相应文字提示</summary>
    
    
    
    <category term="编程类" scheme="https://zml3589110.github.io/categories/%E7%BC%96%E7%A8%8B%E7%B1%BB/"/>
    
    <category term="VBA" scheme="https://zml3589110.github.io/categories/%E7%BC%96%E7%A8%8B%E7%B1%BB/VBA/"/>
    
    <category term="前端" scheme="https://zml3589110.github.io/categories/%E5%89%8D%E7%AB%AF/"/>
    
    
    <category term="VBA" scheme="https://zml3589110.github.io/tags/VBA/"/>
    
    <category term="函数" scheme="https://zml3589110.github.io/tags/%E5%87%BD%E6%95%B0/"/>
    
    <category term="ControlTipText" scheme="https://zml3589110.github.io/tags/ControlTipText/"/>
    
  </entry>
  
  <entry>
    <title>VBA函数之一(Format格式化字符串)</title>
    <link href="https://zml3589110.github.io/posts/4237796259.html"/>
    <id>https://zml3589110.github.io/posts/4237796259.html</id>
    <published>2022-06-28T02:59:20.000Z</published>
    <updated>2022-06-28T07:26:49.956Z</updated>
    
    <content type="html"><![CDATA[<p>Format(值,格式(可选参数))</p><h1 id="一、数字格式："><a href="#一、数字格式：" class="headerlink" title="一、数字格式："></a>一、数字格式：</h1><ol><li><p>General Number：普通数字，可以用来去掉千位分隔号和无效 0 。<br>如：Format(“1,234,567.80”, “General Number”)&#x3D;”1234567.8”</p></li><li><p>Currency：货币类型，可添加千位分隔号和货币符号，保留两位小数点。<br>如：Format(1234567, “Currency”)&#x3D;”¥1,234,567.00”</p></li><li><p>Fixed：格式为带两位小数的数字。<br>如：Format(“123456”, “Fixed”)&#x3D;123456.00</p></li><li><p>Standard：标准，即带千位分隔号和两位小数。<br>如：Format(“123456”, “Standard”)&#x3D;123,456.00</p></li><li><p>Percent：带两位小数点的百分数。<br>如：Format(“123456”, “Percent”)&#x3D;12345600.00</p></li><li><p>Scientific：科学记数法。<br>如：Format(“1234567”, “Scientific”)&#x3D;1.23E+06</p></li><li><p>Yes&#x2F;No：当数值为非 0 数字时返回 Yes ，否则返回 No 。<br>“如：Format(-3.14, “Yes&#x2F;No”)&#x3D;”Yes”<br>Format(0, “Yes&#x2F;No”)&#x3D;”No”</p></li><li><p>True&#x2F;False：当数值为非 0 数字时返回 True ，否则返回 False 。<br>与第7点类似，这里不再举例。</p></li><li><p>On&#x2F;Off：当数值为非 0 数字时返回 On ，否则返回 Off 。<br>与第7点类似，这里不再举例。</p></li><li><p>“”或省略：返回原值，但去除了小数点前后的无效 0 。<br>如：Format(“0.1030”, “”)&#x3D;”.103”</p></li><li><p>0：占位格式化，不足位时补足 0 。<br>“如：Format(123, “0000”)&#x3D;”0123”<br>Format$(12.3, “0.00”)&#x3D;”12.30”</p></li><li><p>#：占位格式化，不足位时不补足 0 。<br>如：Format(123, “####”)&#x3D;123</p></li><li><p>%：转化为百分数，一个%代表乘以 100 。<br>如：Format(1.23, “0.00%”)&#x3D;123.00%<br>Format(1.23, “0.00%%”)&#x3D;12300.00%%</p></li><li><p>：强制显示某字符。<br>如：Format$(12.34, “RMB .00”)&#x3D;”RMB 12.34”</p></li><li><p>;(分号)：分段显示不同格式<br>比如要把正数显示为“正”，负数显示为“负”，0显示为“零”，参数为”正;负;零”<br>如：Format$(123, “正;负;零”)&#x3D;”正”<br>第1段为正数格式，第2段为负数格式，第3段为0格式。</p></li></ol><h1 id="二、日期和时间格式："><a href="#二、日期和时间格式：" class="headerlink" title="二、日期和时间格式："></a>二、日期和时间格式：</h1><ol><li>固定格式参数<br>General Date：基本类型<br>如：Format(“2010-5-1 9:8:5”, “General Date”)&#x3D;”2010&#x2F;5&#x2F;1 9:08:05”<br>Long Date：操作系统定义的长日期<br>如：Format(“2010-5-1 9:8:5”, “Long Date”)&#x3D;2010年5月1日<br>Medium Date：中日期<br>如：Format(“2010-5-1 9:8:5”, “Medium Date”)&#x3D;10-05-01<br>Short Date：操作系统定义的短日期<br>如：Format(“2010-5-1 9:8:5”, “Short Date”)&#x3D;2010-5-1<br>Long Time：操作系统定义的长时间<br>如：Format(“2010-5-1 9:8:5”, “Long Time”)&#x3D;9:08:05<br>Medium Time:带AM&#x2F;PM(上午&#x2F;下午)的12小时制，不带秒<br>如：Format(“2010-5-1 9:8:5”, “Medium Time”)&#x3D;09:08 上午<br>Short Time：24时制的时间，不带秒<br>如：Format(“2010-5-1 9:8:5”, “Short Time”)&#x3D;09:08</li><li>自定义格式<br>C：格式化为国标的日期和时间<br>如：Format(“2010-5-1 9:8:5”, “c”)&#x3D;2010&#x2F;5&#x2F;1 9:08:05<br>y:一年中的第几天(1-366)<br>如：Format(“2010-5-1 9:8:5”, “y”)&#x3D;121<br>yy：两位数的年份(00-99)<br>如：Format(“2010-5-1 9:8:5”, “yy”)&#x3D;10<br>yyy：上面的 yy 与 y 结合在一起<br>“如：Format(“2010-5-1 9:8:5”, “yyy”)&#x3D;10121<br>Format(“2010-5-1 9:8:5”, “yy年第y天”)&#x3D;10年第121天<br>yyyy：四位数的年份(0100-9999)<br>如：Format(“2010-5-1 9:8:5”, “yyyy”)&#x3D;2010<br>d：一个月中的第几天(1-31)<br>如：Format(“2010-5-1 9:8:5”, “d”)&#x3D;1<br>dd：与 d 相同，但不足两位时补足 0<br>如：Format(“2010-5-1 9:8:5”, “dd”)&#x3D;01<br>ddd：三个英文字母表示的星期几<br>如：Format(“2010-5-1 9:8:5”, “ddd”)&#x3D;”Sat”<br>dddd：英文表示的星期几<br>如：Format(“2010-5-1 9:8:5”, “dddd”)&#x3D;”Saturday”<br>ddddd：显示标准日期<br>如：Format(“2010-5-1 9:8:5”, “ddddd”)&#x3D;2010&#x2F;5&#x2F;1<br>dddddd：长日期<br>如：Format(“2010-5-1 9:8:5”, “dddddd”)&#x3D;2010年5月1日<br>w：一个星期中的第几天(始于周日，周日为1)<br>如：Format(“2010-5-1 9:8:5”, “w”)&#x3D;7<br>ww：一年中的第几周<br>如：Format(“2010-5-1 9:8:5”, “ww”)&#x3D;18<br>m：月份数(当用于时间时，也可以表时为分钟)<br>如：Format(“2010-5-1 9:8:5”, “m”)&#x3D;5<br>mm：当小于10时带前导0的月数(当用于时间时，也可以表示为两位数的分钟数)<br>如：Format(“2010-5-1 9:8:5”, “mm”)&#x3D;05<br>mmm：三个英文字母表示的月份数<br>如：Format(“2010-1-1 9:8:5”, “mmm”)&#x3D;”Jan”<br>mmmm：英文表示的月份数<br>如：Format(“2010-1-1 9:8:5”, “mmmm”)&#x3D;”January”<br>q：一年中的第几季(1-4)<br>如：Format(“2010-5-1 9:8:5”, “q”)&#x3D;2<br>aaa：中文表示的周几<br>如：Format(“2010-5-1 9:8:5”, “aaa”)&#x3D;周六<br>aaaa：中文表示的星期几<br>如：Format(“2010-5-1 9:8:5”, “aaaa”)&#x3D;星期六<br>h：小时数(0-23)<br>如：Format(“2010-5-1 9:8:5”, “h”)&#x3D;9<br>h：两位数表示的小时数<br>如：Format(“2010-5-1 9:8:5”, “hh”)&#x3D;09<br>n：分钟数(0-59)<br>如：Format(“2010-5-1 9:8:5”, “n”)&#x3D;8<br>nn：两位数表示的分钟数(00-59)<br>如：Format(“2010-5-1 9:8:5”, “nn”)&#x3D;08<br>s：秒数(0-59)<br>如：Format(“2010-5-1 9:8:5”, “s”)&#x3D;5<br>ss：两位数表示的秒数(00-59)<br>如：Format(“2010-5-1 9:8:5”, “ss”)&#x3D;05<br>ttttt:标准时间，当小时数小于10时不带0，与 h:mm:ss 或 h:nn:ss 相同<br>如：Format(“2010-5-1 9:8:5”, “ttttt”)&#x3D;9:08:05<br>AM&#x2F;PM：显示当前为AM或PM<br>如：Format(“2010-5-1 11:59:59”, “AM&#x2F;PM”)&#x3D;AM<br>Format(“2010-5-1 12:0:0”, “AM&#x2F;PM”)&#x3D;PM<br>A&#x2F;P：显示当前为A或P<br>与 AM&#x2F;PM 一样，这里不再举例。<br>说明：<br>可以多种格式联合使用，如：<br>Format(“2010-5-1 9:8:5”, “dddddd aaaa”)&#x3D;2010年5月1日 星期六</li></ol><h1 id="三、文本格式"><a href="#三、文本格式" class="headerlink" title="三、文本格式"></a>三、文本格式</h1><p>@：匹配位置插入格式化文本，如：</p><p>在”abcde”前插入文本”X”，代码为：Format(“abcde”, “X@”)&#x3D;Xabcde</p><p>在”abcde”第1位字符后面插入文本”X”，代码为：Format(“abcde”, “@X”)&#x3D;aXbcde</p><p>在”abcde”第2位字符后面插入文本”X”，代码为：Format(“abcde”, “@@X”)&#x3D;abXcde</p><p>在”abcde”第3位字符后面插入文本”X”，代码为：Format(“abcde”, “@@@X”)&#x3D;abcXde</p><p>当点位符@比原文本字符串多时，刚在相应位置上添加空格，如：</p><p>Format(“abc”, “X@@@@”)&#x3D;”X abc”</p><p>Format(“abc”, “X@@@@@”)&#x3D;”X  abc”</p><p>Format(“t”, “@@a@”)&#x3D;”  at”(空格空格at)</p><p>与!配合可从后面截取一段文本，如：</p><p>截取”abcde”后面1个字符文本，代码为：Format(“abcde”, “!@”)&#x3D;e</p><p>截取”abcde”后面2个字符文本，代码为：Format(“abcde”, “!@@”)&#x3D;de</p><p>截取”abcde”后面3个字符文本，代码为：Format(“abcde”, “!@@@”)&#x3D;cde</p><p>截取”abcde”后面两位，并在前面添加”XY”，代码为：Format(“abcde”, “!XY@@”)&#x3D;Xyde</p><p>&amp;：字符占位符，与@基本相同，这里不再赘述。</p><p>如：Format$(“I Love You”, “</p><blockquote><p>：强制将所有字符以大写格式显示。</p></blockquote><p>如：Format$(“I Love You”, “&gt;”)&#x3D;I LOVE YOU</p><p>转自：<a href="http://www.cnblogs.com/zhengyuxin/articles/1932724.html">http://www.cnblogs.com/zhengyuxin/articles/1932724.html</a></p><hr><p>Format[$] ( expr [ , fmt ] )</p><p>format 返回变体型</p><p>format$ 强制返回为文本</p><hr><p>数字类型的格式化</p><hr><p>固定格式参数：</p><p>General Number 普通数字，如可以用来去掉千位分隔号</p><p>format$(“100,123.12”,”General Number”) 返回值 100123.12</p><p>Currency 货币类型，可添加千位分隔号和货币符号</p><p>format$(“100123.12”,”Currency”) 返回值 ￥100,123.12</p><p>Fixed 格式为带两位小数的数字</p><p>format$(“100123”,”Fixed”) 返回值 100123.00</p><p>Standard 标准，即带千位分隔号和两位小数</p><p>format$(“100123”,”Standard”) 返回值 100,123.00</p><p>Percent 百分数</p><p>format$(“100123”,”Percent”) 返回值 10012300.00%</p><p>Scientific 科学记数法</p><p>format$(“100123”,”Scientific”) 返回值 1.00E+05</p><p>Yes&#x2F;No 当值为0时返回 NO,否则返回 YES</p><p>format$(“100123”,”Yes&#x2F;No”) 返回值 Yes</p><p>True&#x2F;False 当值为0时返回 False,否则返回 True</p><p>format$(“100123”,”True&#x2F;False”) 返回值 True</p><p>On&#x2F;Off 当值为0时返回 Off,否则返回 On</p><p>format$(“100123”,”Yes&#x2F;No”) 返回值 On</p><p>自定义格式参数</p><p>“” 不进行格式化 返回值 原值</p><p>0 占位格式化，不足补0</p><p>format$(“100123”,”0000000”) 返回值 0100123</p><h1 id="占位格式化，不足时不补0"><a href="#占位格式化，不足时不补0" class="headerlink" title="占位格式化，不足时不补0"></a>占位格式化，不足时不补0</h1><p>format$(“100123”,”#######”) 返回值 100123</p><p>. 强制显示小数点</p><p>format$(“100123.12”,”.000”) 返回值 100123.120</p><p>% 转化为百分数，一个%代表乘以100</p><p>format$(“10.23”,”0.00%”) 返回值 1023.00%</p><p>format$(“10.23”,”0.00%%”) 返回值 102300.00%%</p><p>, 以千为单位格化</p><p>format$(“10.23”,”,”) 返回值 0</p><p>format$(“10010.23”,”,”) 返回值 10</p><p>format$(“10010.23”,”,0.00”) 返回值 10.01</p><p>E- E+ e- e+ 显示为科学记数(要注意格式语句，否则会和E的其它含义相混)</p><p>Format$(12.5,”0.00E+00”) 返回值 1.25E+01</p><p>$ 强制显示货币符号</p><p>format$(“10.23”,”{threadcontent}.00”) 返回值 ￥10.23</p><ul><li><ul><li>( ) space 按位置显示本样</li></ul></li></ul><p>Format$(“1234.56”,”-(0.00)”) 返回值 -(1234.56)</p><p>转义符,显示出特殊符号</p><p>Format$(“1234.56”,”#.00”) 返回值 #1234.56</p><p>“ABC” 显示双引号 (“ “) 之内的字符串。如在代码中想在 format 中包含一个字符串，必须用 Chr(34) 将文本括起来(34 为双引号 (“))</p><p>Format$(123.45,”TTT”) 返回值 TTT</p><p>注：当双引号中的文本包含特殊的参数符号如e,要使用转义符””，否则会按e的作用显示</p><p>; 类似多目运算符的作用。</p><p>当共有 四 部分时，</p><p>当大于0时，按第一部分进行格式化，</p><p>当小于0时按第二部分进行格式化，</p><p>当等于0时按第三部分进行格式化，</p><p>当为null值时，按第四部分进行格式化。如：</p><p>Format$(0,”0.00;负数;零;空”) 返回值 零</p><p>当共有 三 部分时，</p><p>当大于0时，按第一部分进行格式化，</p><p>当小于0时按第二部分进行格式化，</p><p>当等于0时按第三部分进行格式化，如：</p><p>Format$(-10,”0.00;ttt;零”) 返回值 ttt</p><p>当共有 两 部分时，</p><p>当大于或等于0时，按第一部分进行格式化，</p><p>当小于0时按第二部分进行格式化，</p><p>Format$(-123,”0.00;abc”) 返回值 abc</p><p>Format$(123,”0.00;abc”) 返回值 123.00</p><p>当共有 一 部分时，按分号左边进行格式化</p><hr><p>日期类型的格式化</p><hr><p>注意：在中文操作系统中，系统自动将月份输为如：五月，而非 May</p><p>固定格式参数</p><p>General Date 基本类型</p><p>Format(Date,”YYYY年MM月DD日”)</p><p>‘M 个位月只显示一位，</p><p>‘MM 显示两位月，</p><p>‘MMM显示英文月简称,</p><p>‘MMMM显示英文全名</p><p>Format$(Now,”General Date”) 返回值 2006-5-25 14:56:15</p><p>Long Date 操作系统定义的长日期</p><p>Format$(Now,”Long Date”) 返回值 2006年5月25日</p><p>Medium Date 中日期(yy&#x2F;mmm&#x2F;dd)</p><p>Format$(Now,”Medium Date”) 返回值 06-5月-25</p><p>Short Date 操作系统定义的短日期</p><p>Format$(Now,”Short Date”) 返回值 2006-5-25</p><p>Long Time 操作系统定义的长时间</p><p>Format$(Now,”Long Time”) 返回值 15:06:36</p><p>Medium Time 带AM&#x2F;PM的12小时制，不带秒</p><p>Format$(Now,”Medium Time”) 返回值 03:08 PM</p><p>Short Time 24时制的时间，不带秒</p><p>Format$(Now,”Short Time”) 返回值 15:08</p><p>自定义格式参数</p><p>: 用来标识时间字符的间隔</p><p>Format$(Time(),”hh:nn”) 返回值 15:25</p><p>&#x2F; 用来标识日期字符的间隔</p><p>Format$(now,”yyyy&#x2F;mm&#x2F;dd”) 返回值 2006-05-25</p><p>c 格式化为国标的日期和时间</p><p>Format$(Now,”c”) 返回值 2006-5-25 14:56:15</p><p>y 一年中的第几天</p><p>Format$(Now,”y”) 返回值 145</p><p>d 一个月中的第几天(1-366)</p><p>Format$(Now,”d”) 返回值 25</p><p>dd 当小于10时前面带0的天数(01-31)</p><p>Format$(“2006-1-7”,”dd”) 返回值 07</p><p>ddd 周几</p><p>Format$(Now,”ddd”) 返回值 周四</p><p>dddd 星期几</p><p>Format$(Now,”dddd”) 返回值 星期四</p><p>ddddd 显示标准日期</p><p>Format$(Now,”ddddd”) 返回值 2006-05-25</p><p>dddddd 长日期</p><p>Format$(Now,”dddddd”) 返回值 2006年5月25日</p><p>w 一个星期中的第几天</p><p>Format$(Now,”w”) 返回值 5</p><p>ww 一年中的第几周</p><p>Format$(Now,”ww”) 返回值 21</p><p>m 月数(注：当用于时间时，也可以表时为分钟)</p><p>Format$(Now,”m”) 返回值 5</p><p>Format$(Now,”h:m”) 返回值 16:11</p><p>mm 当小于10时前面带0的月数(注：当用于时间时，也可以表时为带0的分钟)</p><p>Format$(Now,”m”) 返回值 05</p><p>Format$(Now,”hh:mm”) 返回值 16:09</p><p>mmm 月份</p><p>Format$(Now,”mmm”) 返回值 五月</p><p>q 一年中的第几季(1-4)</p><p>Format$(Now,”q”) 返回值 2</p><p>yy 两位数的年份(00-99)</p><p>Format$(Now,”yy”) 返回值 06</p><p>yyyy 四位数的年份(0100-9999)</p><p>Format$(Now,”yyyy”) 返回值 2006</p><p>h 一天中的第N小时(0-23)</p><p>Format$(Now,”h”) 返回值 16</p><p>hh 当小于10时带0的小时数(00-23)</p><p>Format$(“7:30:28”,”hh”) 返回值 07</p><p>n 一小时的分钟数(0-59)</p><p>Format$(“7:30:28”,”n”) 返回值 30</p><p>nn 当小于10时带0的分钟数(00-59)</p><p>Format$(“7:3:28”,”n”) 返回值 03</p><p>s 一分钟中的秒数(0-59)</p><p>Format$(“7:30:8”,”s”) 返回值 8</p><p>ss 当小于10时带0的分钟数(00-59)</p><p>Format$(“7:3:8”,”ss”) 返回值 08</p><p>ttttt 标准时间，小时数当小于10时不带0，与h:mm:ss相同</p><p>Format$(“7:3:28”,”ttttt”) 返回值 7:03:28</p><p>AM&#x2F;PM 显示当前为AM或为PM</p><p>Format$(Now,”AM&#x2F;PM”) 返回值 PM</p><p>A&#x2F;P 显示当前为A或为P</p><p>Format$(Now,”A&#x2F;P”) 返回值 P</p><p>AMPM 对0至2359的数值进行判断是AM还是PM，可以看作是同等于对00:00至23:59的数字进行判断，如1000可以看作是10:00。</p><p>Format$(1000,”AMPM”) 返回值 AM</p><p>联合格式化</p><p>m&#x2F;d&#x2F;yy Format$(Now,”m&#x2F;d&#x2F;yy”) 返回值 5-25-06</p><p>d-mmm-yy Format$(Now,”d-mmm-yy”) 返回值 25-5月-06</p><p>d-mmmm Format$(Now,”d-mmmm”) 返回值 25-五月</p><p>mmmm-yy Format$(Now,”mmmm-yy”) 返回值 五月-06</p><p>hh:mm AM&#x2F;PM Format$(Now,”hh:mm AM&#x2F;PM”) 返回值 04:50 PM</p><p>h:mm:ss a&#x2F;p Format$(Now,”h:mm:ss a&#x2F;p”) 返回值 4:51:38 p</p><p>h:mm Format$(Now,”h:mm”) 返回值 16:51</p><p>h:mm:ss Format$(Now,”h:mm:ss”) 返回值 16:51:38</p><p>m&#x2F;d&#x2F;yy h:mm Format$(Now,”m&#x2F;d&#x2F;yy h:mm”) 返回值 5-25-06 16:54</p><hr><p>文本类型的格式化</p><hr><p>; 当两部分时，则第一部分为非空格式化，第二部分为null值或空值的格式化表达式</p><p>@ 匹配位置插入格式化文本，占位位置不存在时，显示空白(空字符串)</p><p>只有一个@符号时，是在最后面加上格式化文本</p><p>Format$(“CHIN”,”@a”) 返回值 CHINa</p><p>有多个@占位符，是按从右至左匹配，并在相应的位置上显示格式化文本</p><p>Format$(“CHIN”,”@a@@”) 返回值 CHaIN</p><p>当与 ! 配合时，则变为从左至右匹配</p><p>Format$(“CHIN”,”[email&#x3D;!@a]!@a[&#x2F;email]@@”) 返回值 CaHIN</p><p>当占位符比原文本字符串多时，刚在相应位置上添加空格</p><p>Format$(“C”,”@@a@”) 返回值 空白空白aC</p><p>&amp; 字符占位符。除在当占位位置不存在时，不显示外，其余均与@相同</p><p>当占位符比原文本字符串多时，刚在相应位置上添加空格</p><p>Format$(“C”,”&amp;&amp;a&amp;”) 返回值 aC</p><p>&lt; 强制小写。将所有字符以小写格式显示。</p><p>Format$(“I love you”,”</p><blockquote><p>强制大写。将所有字符以大写格式显示。</p></blockquote><p>Format$(“I love you”,”&gt;”) 返回值 I LOVE YOU</p><p>! 强制由左而右填充字符占位符。缺省值是由右而左填充字符占位符。</p><p>Format$(“CHIN”,”[email&#x3D;!@a]!@a[&#x2F;email]@@”) 返回值 CaHIN</p><hr><p>强制使用中文格式的日期时间</p><hr><p>aaaa 星期</p><p>Format$(Now,”aaaa”) 返回值 星期五</p><p>O 中文月份</p><p>Format$(Now,”O”) 返回值 五月</p><p>o 单字节月份</p><p>Format$(Now,”o”) 返回值 5月</p><p>A 中文日期</p><p>Format$(Now,”A”) 返回值 二十六日</p><p>a 单字节日期</p><p>Format$(Now,”a”) 返回值 26日</p><p>E 短中文年份</p><p>Format$(Now,”E”) 返回值 六年</p><p>e 单单字节年份</p><p>Format$(Now,”e”) 返回值 6年</p><p>EE 中文年份</p><p>Format$(Now,”EE”) 返回值 二○○六年</p><p>ee 单字节年份</p><p>Format$(Now,”ee”) 返回值 2006年</p><p>想不到中文日期的问题就这么容易解决</p><hr><h1 id="相关链接"><a href="#相关链接" class="headerlink" title="相关链接"></a>相关链接</h1><ol><li><a href="https://blog.csdn.net/weixin_36076151/article/details/112054745">vbaformat_VBA 格式化字符串 - Format大全</a></li></ol><hr><center><font color="red">=================我是分割线=================</font></center><p><strong>欢迎到公众号来唠嗑:</strong></p><img src="https://pic4.zhimg.com/80/v2-eedc5dc7d30beedf4c2f1812df8e61a7_720w.jpg">]]></content>
    
    
    <summary type="html">Format 函数与工作表函数 TEXT 用法基本相同，但功能更加强大，许多格式只能用于VBA 的 Format 函数</summary>
    
    
    
    <category term="编程类" scheme="https://zml3589110.github.io/categories/%E7%BC%96%E7%A8%8B%E7%B1%BB/"/>
    
    <category term="VBA" scheme="https://zml3589110.github.io/categories/%E7%BC%96%E7%A8%8B%E7%B1%BB/VBA/"/>
    
    <category term="前端" scheme="https://zml3589110.github.io/categories/%E5%89%8D%E7%AB%AF/"/>
    
    
    <category term="VBA" scheme="https://zml3589110.github.io/tags/VBA/"/>
    
    <category term="函数" scheme="https://zml3589110.github.io/tags/%E5%87%BD%E6%95%B0/"/>
    
    <category term="Format" scheme="https://zml3589110.github.io/tags/Format/"/>
    
  </entry>
  
  <entry>
    <title>VBA控件之一(MultiPage 控件)</title>
    <link href="https://zml3589110.github.io/posts/3549931295.html"/>
    <id>https://zml3589110.github.io/posts/3549931295.html</id>
    <published>2022-06-28T02:30:20.000Z</published>
    <updated>2022-06-28T07:26:49.941Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>使用 MultiPage 控件来处理大量可被分为几类排序信息。 MultiPage 控件由组成一个或多个 Page 对象， 每个包含不同组的控件。 以编程方式通过设置 MultiPage 控件的 Value 属性设置活动页。</p></blockquote><h1 id="方式一、如何控制-MultiPage-控件编程"><a href="#方式一、如何控制-MultiPage-控件编程" class="headerlink" title="方式一、如何控制 MultiPage 控件编程"></a>方式一、如何控制 MultiPage 控件编程</h1><p><strong>要添加 MultiPage 控件并控制它通过使用宏, 请按照下列步骤操作：</strong></p><table><thead><tr><th>1.</th><th>启动 Excel, 并打开新空白工作簿。</th></tr></thead><tbody><tr><td>2.</td><td>在 工具 菜单, 指向 宏 , 然后单击 VisualBasic 编辑器 。</td></tr><tr><td>3.</td><td>在 插入 菜单上, 单击要在工作簿中插入 UserForm UserForm 。</td></tr><tr><td>4.</td><td>添加到 UserForm MultiPage 控件。</td></tr><tr><td>5.</td><td>将 Label 控件添加到 Page 1 多页 控件上。</td></tr><tr><td>6.</td><td>将 TextBox 控件添加到 Page 1 多页 控件上。</td></tr><tr><td>7.</td><td>MultiPage 控件, 上单击, Page 2 ， 然后重复步骤 5 和 6 以添加一个 Label 控件和 TextBox 控件。</td></tr><tr><td>8.</td><td>双击要打开代码窗口对 MultiPage 控件 MultiPage 控件。</td></tr><tr><td>9.</td><td>在代码窗口, 为 MultiPage1 Change 事件键入下列代码：</td></tr><tr><td>10.</td><td>在代码窗口, 为 UserForm Initialize 事件键入下列代码：</td></tr><tr><td>11.</td><td>在 运行 菜单上, 单击 运行子过程 &#x2F; 用户窗体 。  Page 1, 上 TextBox 控件中键入 Test 。 当单击 Page 2 选项卡、 TextBox 2 被清除, 和标题为 Label 2 变为项， 在 Page 1 上 TextBox 所做 （” Test “) （” Test “）</td></tr></tbody></table><ul><li>为 MultiPage1 Change 事件键入下列代码:<figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Private</span> <span class="keyword">Sub</span> MultiPage1_Change()</span><br><span class="line">            <span class="keyword">Select</span> <span class="keyword">Case</span> MultiPage1.Value</span><br><span class="line">            <span class="comment">&#x27; If activating Page1...</span></span><br><span class="line">            <span class="keyword">Case</span> <span class="number">0</span></span><br><span class="line">            Label1.Caption = TextBox2.<span class="keyword">Text</span></span><br><span class="line">            TextBox1.<span class="keyword">Text</span> = <span class="string">&quot;&quot;</span></span><br><span class="line">            <span class="comment">&#x27; If activating Page2...</span></span><br><span class="line">            <span class="keyword">Case</span> <span class="number">1</span></span><br><span class="line">            Label2.Caption = TextBox1.<span class="keyword">Text</span></span><br><span class="line">            TextBox2.<span class="keyword">Text</span> = <span class="string">&quot;&quot;</span></span><br><span class="line">            <span class="keyword">End</span> <span class="keyword">Select</span></span><br><span class="line">            <span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure></li><li>为 UserForm Initialize 事件键入下列代码：<figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Private</span> <span class="keyword">Sub</span> UserForm_Initialize()</span><br><span class="line">            <span class="comment">&#x27; Force Page1 to be active when UserForm is displayed.</span></span><br><span class="line">            MultiPage1.Value = <span class="number">0</span></span><br><span class="line">            Label1.Caption = <span class="string">&quot;&quot;</span></span><br><span class="line">            <span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure></li></ul><h2 id="如何通过使用-MultiPage-控件创建一个向导界面"><a href="#如何通过使用-MultiPage-控件创建一个向导界面" class="headerlink" title="如何通过使用 MultiPage 控件创建一个向导界面"></a>如何通过使用 MultiPage 控件创建一个向导界面</h2><p>将任务需要几个增量步骤, 向导界面可能会非常有效。 您可使用 MultiPage 控件以创建一个向导界面代替使用多用户窗体。 本示例操作具有三页 MultiPage 控件。 附加到对 UserForm Initialize 事件过程禁用 Page 2 和 Page3, 并强制 Page 1 的 多页 控件可活动。</p><p><strong>注意</strong> 您通过使用 <strong>Pages</strong> 集合, 索引 <strong>MultiPage</strong> 控件的页面时集合中第一页是零页。 此过程还设置标题的 <strong>CommandButton</strong> 控件并禁用 <strong>&lt; 备份</strong> 按钮。</p><p>注意的功能是分配给 CommandButton 1 控件的 Click 事件过程 “ 后退 “ 按钮 &lt; 是分配给 CommandButton 2 是 Click 事件过程控制功能的下一步 &gt; 按钮。 若要通过使用 <strong>MultiPage</strong> 控件, 创建一个向导界面请按照下列步骤：</p><table><thead><tr><th>1.</th><th>启动 Excel, 并打开新空白工作簿。</th></tr></thead><tbody><tr><td>2.</td><td>在 工具 菜单, 指向 宏 , 然后单击 VisualBasic 编辑器 。</td></tr><tr><td>3.</td><td>在 插入 菜单上, 单击要在工作簿中插入 UserForm UserForm 。</td></tr><tr><td>4.</td><td>添加到 UserForm MultiPage 控件。</td></tr><tr><td>5.</td><td>右键单击, “ Page 1 选项卡， 然后单击要添加到 多页 控件 Page3 新页 。</td></tr><tr><td>6.</td><td>添加一个 CommandButton 控件不位于 多页 控件上 UserForm 上。  重复此步骤可添加一个 UserForm 上二 CommandButton 控件。</td></tr><tr><td>7.</td><td>双击以打开代码窗口对于 UserForm UserForm 。</td></tr><tr><td>8.</td><td>在代码窗口, 为 UserForm Initialize 事件键入下列代码：</td></tr><tr><td>9.</td><td>在 运行 菜单上, 单击 运行子过程 &#x2F; 用户窗体 。</td></tr></tbody></table><p>当您单击下一步 &gt; 激活 Page 2 后退 “ 按钮可, 和 &lt; 当您单击 Next &gt; 第二次, Page3 激活并题注为 CommandButton 2 更改为 “ 完成 “。</p><figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&#x27;在代码窗口, 为 UserForm Initialize 事件键入下列代码：</span></span><br><span class="line"><span class="keyword">Private</span> <span class="keyword">Sub</span> UserForm_Initialize()</span><br><span class="line">            <span class="keyword">With</span> MultiPage1</span><br><span class="line">            <span class="comment">&#x27; The next 2 lines disable Page2 &amp; Page3.</span></span><br><span class="line">            .Pages(<span class="number">1</span>).Enabled = <span class="literal">False</span></span><br><span class="line">            .Pages(<span class="number">2</span>).Enabled = <span class="literal">False</span></span><br><span class="line">            <span class="comment">&#x27; Make Page1 the active page.</span></span><br><span class="line">            .Value = <span class="number">0</span></span><br><span class="line">            <span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line">            <span class="comment">&#x27; Set the caption on the CommandButtons.</span></span><br><span class="line">            CommandButton1.Caption = <span class="string">&quot;&lt;Back&quot;</span></span><br><span class="line">            CommandButton1.Enabled = <span class="literal">False</span></span><br><span class="line">            CommandButton2.Caption = <span class="string">&quot;Next&gt;&quot;</span></span><br><span class="line">            <span class="keyword">End</span> <span class="keyword">Sub</span></span><br><span class="line">            <span class="comment">&#x27; Procedure for the &quot;&lt;Back&quot; button</span></span><br><span class="line">            <span class="keyword">Private</span> <span class="keyword">Sub</span> CommandButton1_Click()</span><br><span class="line">            <span class="keyword">Select</span> <span class="keyword">Case</span> MultiPage1.Value</span><br><span class="line">            <span class="keyword">Case</span> <span class="number">1</span>                                 <span class="comment">&#x27; If Page2 is active...</span></span><br><span class="line">            <span class="keyword">With</span> MultiPage1</span><br><span class="line">            .Pages(<span class="number">0</span>).Enabled = <span class="literal">True</span>       <span class="comment">&#x27; Enable Page1.</span></span><br><span class="line">            .Value = MultiPage1.Value - <span class="number">1</span>  <span class="comment">&#x27; Move back 1 page.</span></span><br><span class="line">            .Pages(<span class="number">1</span>).Enabled = <span class="literal">False</span>      <span class="comment">&#x27; Disable Page2.</span></span><br><span class="line">            <span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line">            CommandButton1.Enabled = <span class="literal">False</span>     <span class="comment">&#x27; Disable Back button.</span></span><br><span class="line">            <span class="keyword">Case</span> <span class="number">2</span>                                 <span class="comment">&#x27; If Page3 is active...</span></span><br><span class="line">            <span class="keyword">With</span> MultiPage1</span><br><span class="line">            .Pages(<span class="number">1</span>).Enabled = <span class="literal">True</span>       <span class="comment">&#x27; Enable Page2.</span></span><br><span class="line">            .Value = MultiPage1.Value - <span class="number">1</span>  <span class="comment">&#x27; Move back 1 page.</span></span><br><span class="line">            .Pages(<span class="number">2</span>).Enabled = <span class="literal">False</span>      <span class="comment">&#x27; Disable Page3.</span></span><br><span class="line">            CommandButton2.Caption = <span class="string">&quot;Next&gt;&quot;</span></span><br><span class="line">            <span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line">            <span class="keyword">End</span> <span class="keyword">Select</span></span><br><span class="line">            <span class="keyword">End</span> <span class="keyword">Sub</span></span><br><span class="line">            <span class="comment">&#x27; Procedure for the &quot;Next&gt;&quot; button</span></span><br><span class="line">            <span class="keyword">Private</span> <span class="keyword">Sub</span> CommandButton2_Click()</span><br><span class="line">            <span class="keyword">Select</span> <span class="keyword">Case</span> MultiPage1.Value</span><br><span class="line">            <span class="keyword">Case</span> <span class="number">0</span>                                  <span class="comment">&#x27; If Page1 is active...</span></span><br><span class="line">            <span class="keyword">With</span> MultiPage1</span><br><span class="line">            .Value = MultiPage1.Value + <span class="number">1</span>   <span class="comment">&#x27; Move forward 1 page.</span></span><br><span class="line">            .Pages(<span class="number">1</span>).Enabled = <span class="literal">True</span>        <span class="comment">&#x27; Enable Page2.</span></span><br><span class="line">            .Pages(<span class="number">0</span>).Enabled = <span class="literal">False</span>       <span class="comment">&#x27; Disable Page1.</span></span><br><span class="line">            <span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line">            CommandButton1.Enabled = <span class="literal">True</span>       <span class="comment">&#x27; Enable Back button.</span></span><br><span class="line">            <span class="keyword">Case</span> <span class="number">1</span>                                  <span class="comment">&#x27; If Page2 is active...</span></span><br><span class="line">            <span class="keyword">With</span> MultiPage1</span><br><span class="line">            .Value = MultiPage1.Value + <span class="number">1</span>   <span class="comment">&#x27; Move forward 1 page.</span></span><br><span class="line">            .Pages(<span class="number">2</span>).Enabled = <span class="literal">True</span>        <span class="comment">&#x27; Enable Page3.</span></span><br><span class="line">            .Pages(<span class="number">1</span>).Enabled = <span class="literal">False</span>       <span class="comment">&#x27; Disable Page2.</span></span><br><span class="line">            <span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line">            CommandButton2.Caption = <span class="string">&quot;Finish&quot;</span>   <span class="comment">&#x27; Change Next button to Finish.</span></span><br><span class="line">            <span class="keyword">Case</span> <span class="number">2</span>                                  <span class="comment">&#x27; If Page3 is active...</span></span><br><span class="line">            MsgBox <span class="string">&quot;Finished!&quot;</span>                  <span class="comment">&#x27; User is Finished.</span></span><br><span class="line">            Unload <span class="keyword">Me</span>                           <span class="comment">&#x27; Unload the UserForm.</span></span><br><span class="line">            <span class="keyword">End</span> <span class="keyword">Select</span></span><br><span class="line">            <span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure><h1 id="方式二、vba-Page分页控件使用方法介绍"><a href="#方式二、vba-Page分页控件使用方法介绍" class="headerlink" title="方式二、vba Page分页控件使用方法介绍"></a>方式二、vba Page分页控件使用方法介绍</h1><blockquote><p>基本说一下Page使用方法，包括添加分页、删除分页、和设置分页属性等几点比较重要的内容。</p></blockquote><img src="https://pics7.baidu.com/feed/cc11728b4710b912705faeb15852f4049345221d.png?token=c36a6abd99ef68a91642e2b228bb790b"><ul><li>一个表单示例，标题分布以按钮形式来显示，默认为标签形式。</li></ul><h2 id="设置方法"><a href="#设置方法" class="headerlink" title="设置方法:"></a>设置方法:</h2><figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">With</span> </span><br><span class="line"><span class="keyword">Me</span>.MultiPage1.Style = fmTabStyleButtons<span class="comment">&#x27;按钮形式&#x27;.Style = fmTabStyleTabs &#x27;默认为标签形式</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">With</span></span><br></pre></td></tr></table></figure><ul><li><strong>背景图片设置</strong><blockquote><p>背景图片用loadpicture(＂图片路径＋文件名＂)加载</p></blockquote></li></ul><img src="https://pics3.baidu.com/feed/0b55b319ebc4b7453a545da552531610888215f3.png?token=38556e3bc454b547afa9a1bc9094b262"><p><strong>使用方法如下:</strong></p><figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Me</span>.MultiPage1.Pages.Item(<span class="number">1</span>).Picture =_</span><br><span class="line">LoadPicture(ThisWorkbook.Path &amp; <span class="string">&quot;\pic\123.jpg&quot;</span>)</span><br></pre></td></tr></table></figure><blockquote><p><strong>其中注意一点Item(i),item表示Page页 字母ｉ代表下标或索引值.索引值从0开始,也就是说第一个Page页用item(0)来代表,最后一个用item(pages.count-1)来表示.</strong></p></blockquote><img src="https://pics5.baidu.com/feed/a1ec08fa513d26976f8965acc954bafc4216d81b.png?token=67b7980f1cab07044562d95e4c671f98"><ul><li><strong>改变按钮宽度</strong><blockquote><p>这个功能其实就是设置分布标题大小,用TabFixedWidth设置宽,TabFixedHeight设置高.</p></blockquote></li></ul><img src="https://pics6.baidu.com/feed/5ab5c9ea15ce36d3e51f355aa45c3280e850b1f3.png?token=bebe6e9095c7dfe11b7ec89dea1fabd6"><p><strong>使用方法如下:</strong></p><figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> </span><br><span class="line"><span class="keyword">Me</span>.MultiPage1.TabFixedWidth = <span class="number">80</span>.TabFixedHeight=<span class="number">28</span></span><br><span class="line">endwith</span><br></pre></td></tr></table></figure><ul><li><strong>新建分页</strong></li></ul><blockquote><p>新建分页也十分简单,一行代码就可以完成. MultiPage1.Pages.Add “分布名”,”标题名”,索引值</p></blockquote><img src="https://pics1.baidu.com/feed/a9d3fd1f4134970aa044a46c0965d9cfa6865df0.png?token=96dba0ed08723058977dcf9210d191f5"><p><strong>使用方法如下:</strong></p><figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Dim</span> x <span class="keyword">As</span> Integerx = <span class="keyword">Me</span>.MultiPage1.Pages.Count</span><br><span class="line"><span class="keyword">If</span> x &gt; <span class="number">6</span> <span class="keyword">Then</span> </span><br><span class="line"><span class="keyword">Exit</span> <span class="keyword">Sub</span></span><br><span class="line"><span class="keyword">Me</span>.MultiPage1.Pages.Add <span class="string">&quot;page&quot;</span> &amp; x, <span class="string">&quot;新建 &quot;</span> &amp; x &amp; <span class="string">&quot;#&quot;</span>, x</span><br></pre></td></tr></table></figure><ul><li><strong>删除分页</strong><blockquote><p>删除分页也是一行代码完成的,Me.MultiPage1.Pages.Remove 索引</p></blockquote></li></ul><img src="https://pics5.baidu.com/feed/9825bc315c6034a821d4f4b357bc415309237600.png?token=5599e8d77a6492b808dba31ad0cc1f24"><p><strong>使用方法如下:</strong></p><figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Dim</span> i <span class="keyword">As</span> Integeri = <span class="keyword">Me</span>.MultiPage1.Pages.Count - <span class="number">1</span><span class="comment">&#x27;取最后一个分布索引号</span></span><br><span class="line"><span class="keyword">If</span> i &lt;= <span class="number">4</span> <span class="keyword">Then</span> </span><br><span class="line"><span class="keyword">Exit</span> <span class="keyword">Sub</span><span class="comment">&#x27;判断是否是删除页 不能把自己删除了</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Me</span>.MultiPage1.Pages.Remove i<span class="comment">&#x27;执行删除分页</span></span><br></pre></td></tr></table></figure><ul><li>结尾<br>其实对分页控件用得不是很熟悉,所以也是边学边做,,有些错误的地方,就难免.<br>同时也希望指出不正确的地方,加以改正.<br>关注江觅学习更多vba编程技术</li></ul><hr><h1 id="相关链接"><a href="#相关链接" class="headerlink" title="相关链接"></a>相关链接</h1><ol><li><a href="https://blog.csdn.net/liyanwwww/article/details/2653539">VBA控件常规使用–multiPage 控件</a></li><li><a href="https://baijiahao.baidu.com/s?id=1673353087367441194&wfr=spider&for=pc">vba Page分页控件使用方法介绍</a></li></ol><hr><center><font color="red">=================我是分割线=================</font></center><p><strong>欢迎到公众号来唠嗑:</strong></p><img src="https://pic4.zhimg.com/80/v2-eedc5dc7d30beedf4c2f1812df8e61a7_720w.jpg">]]></content>
    
    
    <summary type="html">使用 MultiPage 控件来处理大量可被分为几类排序信息</summary>
    
    
    
    <category term="编程类" scheme="https://zml3589110.github.io/categories/%E7%BC%96%E7%A8%8B%E7%B1%BB/"/>
    
    <category term="VBA" scheme="https://zml3589110.github.io/categories/%E7%BC%96%E7%A8%8B%E7%B1%BB/VBA/"/>
    
    <category term="前端" scheme="https://zml3589110.github.io/categories/%E5%89%8D%E7%AB%AF/"/>
    
    
    <category term="VBA" scheme="https://zml3589110.github.io/tags/VBA/"/>
    
    <category term="控件" scheme="https://zml3589110.github.io/tags/%E6%8E%A7%E4%BB%B6/"/>
    
    <category term="MultiPage" scheme="https://zml3589110.github.io/tags/MultiPage/"/>
    
  </entry>
  
  <entry>
    <title>VBA窗体最大化最小化按钮实现</title>
    <link href="https://zml3589110.github.io/posts/24674706.html"/>
    <id>https://zml3589110.github.io/posts/24674706.html</id>
    <published>2022-06-28T01:51:20.000Z</published>
    <updated>2022-06-28T07:26:49.941Z</updated>
    
    <content type="html"><![CDATA[<h1 id="先建立窗体"><a href="#先建立窗体" class="headerlink" title="先建立窗体"></a>先建立窗体</h1><p>打开excel，找到开发工具 ，然后点击 Visual Basic进入代码编辑器窗口：</p><img src="https://img-blog.csdnimg.cn/2018120723042229.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3UwMTAyODAwNzU=,size_16,color_FFFFFF,t_70"><p>点击插入&gt;&gt;用户窗体，如下图所示：</p><img src="https://img-blog.csdnimg.cn/20181207230608410.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3UwMTAyODAwNzU=,size_16,color_FFFFFF,t_70"><p>如果此时运行，得到的效果如下所示，是没有最大化和最小化窗口的：</p><img src="https://img-blog.csdnimg.cn/20181207232333794.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3UwMTAyODAwNzU=,size_16,color_FFFFFF,t_70"><h1 id="设置方式"><a href="#设置方式" class="headerlink" title="设置方式"></a>设置方式</h1><p>下面我们就来添加最大化最小化功能的实现。<br>双击窗体，进入代码编辑界面，输入以下代码：</p><figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Option</span> <span class="keyword">Explicit</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Private</span> <span class="keyword">Declare</span> PtrSafe <span class="keyword">Function</span> GetWindowLong <span class="keyword">Lib</span> <span class="string">&quot;user32&quot;</span> <span class="keyword">Alias</span> <span class="string">&quot;GetWindowLongA&quot;</span> (<span class="keyword">ByVal</span> hWnd <span class="keyword">As</span> <span class="type">Long</span>, <span class="keyword">ByVal</span> nIndex <span class="keyword">As</span> <span class="type">Long</span>) <span class="keyword">As</span> <span class="type">Long</span></span><br><span class="line"><span class="keyword">Private</span> <span class="keyword">Declare</span> PtrSafe <span class="keyword">Function</span> FindWindow <span class="keyword">Lib</span> <span class="string">&quot;user32&quot;</span> <span class="keyword">Alias</span> <span class="string">&quot;FindWindowA&quot;</span> (<span class="keyword">ByVal</span> lpClassName <span class="keyword">As</span> <span class="type">String</span>, <span class="keyword">ByVal</span> lpWindowName <span class="keyword">As</span> <span class="type">String</span>) <span class="keyword">As</span> <span class="type">Long</span></span><br><span class="line"><span class="keyword">Private</span> <span class="keyword">Declare</span> PtrSafe <span class="keyword">Function</span> SetWindowLong <span class="keyword">Lib</span> <span class="string">&quot;user32&quot;</span> <span class="keyword">Alias</span> <span class="string">&quot;SetWindowLongA&quot;</span> (<span class="keyword">ByVal</span> hWnd <span class="keyword">As</span> <span class="type">Long</span>, <span class="keyword">ByVal</span> nIndex <span class="keyword">As</span> <span class="type">Long</span>, <span class="keyword">ByVal</span> dwNewLong <span class="keyword">As</span> <span class="type">Long</span>) <span class="keyword">As</span> <span class="type">Long</span></span><br><span class="line"><span class="keyword">Private</span> <span class="keyword">Const</span> GWL_STYLE = (-<span class="number">16</span>)</span><br><span class="line"><span class="keyword">Private</span> <span class="keyword">Const</span> WS_THICKFRAME <span class="keyword">As</span> <span class="type">Long</span> = <span class="number">&amp;H40000</span> <span class="comment">&#x27;(恢复大小)</span></span><br><span class="line"><span class="keyword">Private</span> <span class="keyword">Const</span> WS_MINIMIZEBOX <span class="keyword">As</span> <span class="type">Long</span> = <span class="number">&amp;H20000</span> <span class="comment">&#x27;(最小化)</span></span><br><span class="line"><span class="keyword">Private</span> <span class="keyword">Const</span> WS_MAXIMIZEBOX <span class="keyword">As</span> <span class="type">Long</span> = <span class="number">&amp;H10000</span> <span class="comment">&#x27;(最大化)</span></span><br><span class="line"><span class="keyword">Private</span> <span class="keyword">Sub</span> UserForm_Initialize()</span><br><span class="line">   <span class="keyword">Dim</span> hWndForm <span class="keyword">As</span> <span class="type">Long</span></span><br><span class="line">   <span class="keyword">Dim</span> IStyle <span class="keyword">As</span> <span class="type">Long</span></span><br><span class="line">   hWndForm = FindWindow(<span class="string">&quot;ThunderDFrame&quot;</span>, <span class="keyword">Me</span>.Caption)</span><br><span class="line">   IStyle = GetWindowLong(hWndForm, GWL_STYLE)</span><br><span class="line">   IStyle = IStyle <span class="built_in">Or</span> WS_THICKFRAME <span class="comment">&#x27;还原</span></span><br><span class="line">   IStyle = IStyle <span class="built_in">Or</span> WS_MINIMIZEBOX <span class="comment">&#x27;最小化</span></span><br><span class="line">   IStyle = IStyle <span class="built_in">Or</span> WS_MAXIMIZEBOX <span class="comment">&#x27;最大化</span></span><br><span class="line">   SetWindowLong hWndForm, GWL_STYLE, IStyle</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>将鼠标置于Sub函数内部，按F5按键运行，得到如下效果：</p><img src="https://img-blog.csdnimg.cn/20181207231350402.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3UwMTAyODAwNzU=,size_16,color_FFFFFF,t_70"><p><strong>这里需要说明的是，以上代码支持在64位操作系统运行，如果是32位系统，在导入库的时候，应使用下面一段代码:</strong></p><p>与前面一段代码相比，发现唯一的区别在于，Declare后面少了PtrSafe，其原因是：Microsoft 提供了一个 Win32API.txt 文件，其中包含 1,500 个 Declare 语句以及一个用于剪切所需 Declare 语句并将其粘贴到您的代码中的工具。不过，这些语句适用于 32 位系统，必须使用下文讨论的信息将其转换为 64 位。现有 Declare 语句在 64 位 VBA 中不会进行编译，直到使用 PtrSafe 属性将它们标记为对 64 位安全。</p><p>具体可参阅MicroSoft Office 官方资料：<a href="https://docs.microsoft.com/zh-cn/previous-versions/office/ee691831(v=office.14)">32 位和 64 位版本的 Office 2010 之间的兼容性</a></p><hr><h1 id="相关链接"><a href="#相关链接" class="headerlink" title="相关链接"></a>相关链接</h1><ol><li><a href="https://blog.csdn.net/u010280075/article/details/84888744">VBA窗体最大化最小化按钮实现</a></li></ol><hr><center><font color="red">=================我是分割线=================</font></center><p><strong>欢迎到公众号来唠嗑:</strong></p><img src="https://pic4.zhimg.com/80/v2-eedc5dc7d30beedf4c2f1812df8e61a7_720w.jpg">]]></content>
    
    
    <summary type="html">VBA窗体添加最大化最小化按钮实现</summary>
    
    
    
    <category term="编程类" scheme="https://zml3589110.github.io/categories/%E7%BC%96%E7%A8%8B%E7%B1%BB/"/>
    
    <category term="VBA" scheme="https://zml3589110.github.io/categories/%E7%BC%96%E7%A8%8B%E7%B1%BB/VBA/"/>
    
    <category term="前端" scheme="https://zml3589110.github.io/categories/%E5%89%8D%E7%AB%AF/"/>
    
    
    <category term="VBA" scheme="https://zml3589110.github.io/tags/VBA/"/>
    
    <category term="窗体" scheme="https://zml3589110.github.io/tags/%E7%AA%97%E4%BD%93/"/>
    
    <category term="最大最小化" scheme="https://zml3589110.github.io/tags/%E6%9C%80%E5%A4%A7%E6%9C%80%E5%B0%8F%E5%8C%96/"/>
    
  </entry>
  
  <entry>
    <title>窗体上按Esc键关闭窗体（VBA）</title>
    <link href="https://zml3589110.github.io/posts/3269845264.html"/>
    <id>https://zml3589110.github.io/posts/3269845264.html</id>
    <published>2022-06-28T01:46:20.000Z</published>
    <updated>2022-06-28T07:26:49.941Z</updated>
    
    <content type="html"><![CDATA[<h1 id="使用ESC关闭"><a href="#使用ESC关闭" class="headerlink" title="使用ESC关闭"></a>使用ESC关闭</h1><ol><li>在窗体上拖一个按钮控件，命名为 btnCancel，然后将按钮属性 Cancel 设为 True</li></ol><img src="http://miao.blog/images/c2fe3ea3a343c737.jpg"><ol start="2"><li>然后双击按钮，在按钮的 click 事件中写入 Me.Hide</li></ol><figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Private</span> <span class="keyword">Sub</span> btnCancel_Click()</span><br><span class="line">    <span class="keyword">Me</span>.Hide</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure><ol start="3"><li>然后把按钮 Width 和 Height 设置为 0</li></ol><img src="http://miao.blog/images/371969cf39089ad0.jpg"><hr><h1 id="相关链接"><a href="#相关链接" class="headerlink" title="相关链接"></a>相关链接</h1><ol><li><a href="http://miao.blog/article/click-esc-to-close-form">窗体上按Esc键关闭窗体（VBA）</a></li></ol><hr><center><font color="red">=================我是分割线=================</font></center><p><strong>欢迎到公众号来唠嗑:</strong></p><img src="https://pic4.zhimg.com/80/v2-eedc5dc7d30beedf4c2f1812df8e61a7_720w.jpg">]]></content>
    
    
    <summary type="html">窗体上按Esc键关闭窗体（VBA）</summary>
    
    
    
    <category term="编程类" scheme="https://zml3589110.github.io/categories/%E7%BC%96%E7%A8%8B%E7%B1%BB/"/>
    
    <category term="VBA" scheme="https://zml3589110.github.io/categories/%E7%BC%96%E7%A8%8B%E7%B1%BB/VBA/"/>
    
    <category term="前端" scheme="https://zml3589110.github.io/categories/%E5%89%8D%E7%AB%AF/"/>
    
    
    <category term="VBA" scheme="https://zml3589110.github.io/tags/VBA/"/>
    
    <category term="窗体" scheme="https://zml3589110.github.io/tags/%E7%AA%97%E4%BD%93/"/>
    
    <category term="ESC" scheme="https://zml3589110.github.io/tags/ESC/"/>
    
  </entry>
  
  <entry>
    <title>MsgBox函数的讲解及应用</title>
    <link href="https://zml3589110.github.io/posts/2953555089.html"/>
    <id>https://zml3589110.github.io/posts/2953555089.html</id>
    <published>2022-06-28T01:06:20.000Z</published>
    <updated>2022-06-28T07:26:49.941Z</updated>
    
    <content type="html"><![CDATA[<h1 id="MsgBox函数的讲解及应用"><a href="#MsgBox函数的讲解及应用" class="headerlink" title="MsgBox函数的讲解及应用"></a>MsgBox函数的讲解及应用</h1><blockquote><p><strong>所谓函数，指的是一个Function过程，区别于简单的过程，Function过程是有返回值.</strong><br>Excel VBA中的MsgBox函数可以返回结果，而简单的MsgBox语句不能返回结果。</p></blockquote><ol><li>MsgBox函数<blockquote><p>在对话框中显示消息，等待用户单击按钮，并返回一个整数，指示用户单击的那个按钮</p></blockquote></li></ol><ul><li>一、语法:<br>MsgBox (prompt, [ buttons, ] [ title, ] [ helpfile, context ])</li></ul><p>参数：</p><p>① <strong>prompt 必需项</strong>。 字符串表达式在对话框中显示为消息。 prompt 的最大长度约为 1024 个字符，具体取决于所使用的字符的宽度。如果 prompt 包含两行以上，则可以在每行之间使用回车符 (Chr(13))、换行符 (Chr(10)) 或回车换行符组合 (Chr(13) &amp; Chr(10)) 将其分隔。</p><p>② buttons 可选。 数值表达式，用于指定要显示按钮的数量和类型、要使用的图标样式、默认按钮的标识和消息框的形式的值之和。 如果省略，则 buttons 的默认值为 0。</p><p>③ title可选。 对话框标题栏中显示的字符串表达式。 如果省略 title，则标题栏中将显示应用程序名称。</p><p>④ helpfile 可选。 用于标识帮助文件的字符串表达式，前者用于为对话框提供上下文相关的帮助。 如果提供 helpfile，则也必须提供 context。</p><p>⑤ context 可选。 帮助上下文数值的数值表达式，该数值由帮助作者为相应的帮助主题分配。 如果提供 context，则也必须提供 helpfile。</p><ul><li>二、buttons 参数设置如下：</li></ul><table><thead><tr><th align="left">常量</th><th align="left">值</th><th align="left">说明</th></tr></thead><tbody><tr><td align="left">vbOKOnly</td><td align="left">0</td><td align="left">仅显示“确定”按钮。</td></tr><tr><td align="left">vbOKCancel</td><td align="left">1</td><td align="left">显示“确定”和“取消”按钮。</td></tr><tr><td align="left">vbAbortRetryIgnore</td><td align="left">2</td><td align="left">显示“中止”、“重试”和“忽略”按钮。</td></tr><tr><td align="left">vbYesNoCancel</td><td align="left">3</td><td align="left">显示“是”、“否”和“取消”按钮。</td></tr><tr><td align="left">vbYesNo</td><td align="left">4</td><td align="left">显示“是”和“否”按钮。</td></tr><tr><td align="left">vbRetryCancel</td><td align="left">5</td><td align="left">显示“重试”和“取消”按钮。</td></tr><tr><td align="left">vbCritical</td><td align="left">16</td><td align="left">显示“关键消息”图标。</td></tr><tr><td align="left">vbQuestion</td><td align="left">32</td><td align="left">显示“警告查询”图标。</td></tr><tr><td align="left">vbExclamation</td><td align="left">48</td><td align="left">显示“警告消息”图标。</td></tr><tr><td align="left">vbInformation</td><td align="left">64</td><td align="left">显示“信息消息”图标。</td></tr><tr><td align="left">vbDefaultButton1</td><td align="left">0</td><td align="left">第一个按钮是默认按钮。</td></tr><tr><td align="left">vbDefaultButton2</td><td align="left">256</td><td align="left">第二个按钮是默认按钮。</td></tr><tr><td align="left">vbDefaultButton3</td><td align="left">512</td><td align="left">第三个按钮是默认按钮。</td></tr><tr><td align="left">vbDefaultButton4</td><td align="left">768</td><td align="left">第四个按钮是默认按钮。</td></tr><tr><td align="left">vbApplicationModal</td><td align="left">0</td><td align="left">应用程序模式；用户在继续在当前应用程序中工 作前必须响应消息框。</td></tr><tr><td align="left">vbSystemModal</td><td align="left">4096</td><td align="left">系统模式；在用户响应消息框前，所有应用程序都挂起。</td></tr><tr><td align="left">vbMsgBoxHelpButton</td><td align="left">16384</td><td align="left">在消息框中添加“帮助”按钮。</td></tr><tr><td align="left">vbMsgBoxSetForeground</td><td align="left">65536</td><td align="left">将消息框窗口指定为前景窗口。</td></tr><tr><td align="left">vbMsgBoxRight</td><td align="left">524288</td><td align="left">文本右对齐。</td></tr><tr><td align="left">vbMsgBoxRtlReading</td><td align="left">1048576</td><td align="left">指定文本在希伯来语和阿拉伯语系统中应从右到左显示。</td></tr></tbody></table><ul><li><p>三、第一组值 (0-5) 表示对话框中显示的按钮的数量和类型；第二组值（16、32、48、64）表示图标样式；第三组值（0、256、512）用于确定默认按钮；第四组值（0、4096）用于确定消息框的形式。添加数字以创建最终 buttons 参数值时，只是用每个组中的其中一个数值。</p></li><li><p>四、关于返回值</p><table><thead><tr><th align="left">常量</th><th align="left">值</th><th align="left">说明</th></tr></thead><tbody><tr><td align="left">vbOK</td><td align="left">1</td><td align="left">确定</td></tr><tr><td align="left">vbCancel</td><td align="left">2</td><td align="left">Cancel</td></tr><tr><td align="left">vbAbort</td><td align="left">3</td><td align="left">中止</td></tr><tr><td align="left">vbRetry</td><td align="left">4</td><td align="left">重试</td></tr><tr><td align="left">vbIgnore</td><td align="left">5</td><td align="left">忽略</td></tr><tr><td align="left">vbYes</td><td align="left">6</td><td align="left">是</td></tr><tr><td align="left">vbNo</td><td align="left">7</td><td align="left">否</td></tr></tbody></table></li></ul><blockquote><p>如果对话框中显示“取消”按钮，按 ESC 键与单击“取消”具有相同的作用。 如果对话框中包含“帮助”按钮，则会为对话框提供上下文相关帮助。但是，在单击其他按钮中的某个按钮之前不会返回任何值。</p></blockquote><h1 id="MsgBox函数的应用"><a href="#MsgBox函数的应用" class="headerlink" title="MsgBox函数的应用"></a>MsgBox函数的应用</h1><p>为了清空某个工作表，我们可以写一段代码达到我们的目的。但是在运行之前要提供给用户思考的时间，清空后是否有其他的麻烦。我们来看下面的代码：</p><figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> mynzC()</span><br><span class="line"></span><br><span class="line">answer = MsgBox(<span class="string">&quot;你是否要清空工作表?&quot;</span>, vbYesNo + vbQuestion, <span class="string">&quot;清空工作表&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">If</span> answer = vbYes <span class="keyword">Then</span></span><br><span class="line"></span><br><span class="line">Cells.ClearContents</span><br><span class="line"></span><br><span class="line"><span class="keyword">Else</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&#x27;do nothing</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure><p>代码截图：</p><img src="https://pic2.zhimg.com/80/v2-7d3c2b5af0e5a4945f146d5a70de44c1_720w.jpg"><p>代码解读：</p><ol><li>answer &#x3D; MsgBox(“你是否要清空工作表?”, vbYesNo + vbQuestion, “清空工作表”)<br>使用括号时，MsgBox函数有三个参数。第一部分用于消息框中的消息。使用第二部分指定要在消息框中显示的按钮和图标。第三部分显示在消息框的标题栏中。</li></ol><ul><li>注意：将光标放在Visual Basic编辑器中的vbYesNo上，然后单击F1查看可以使用的其他按钮和图标。也可以使用相应的值4和32，而不是常量vbYesNo和vbQuestion。</li></ul><ol start="2"><li>If answer &#x3D; vbYes Then</li></ol><p>Cells.ClearContents</p><p>Else</p><p>‘do nothing</p><p>End If</p><p>如果用户单击“是”按钮，Excel VBA将清空工作表。如果用户单击No按钮，则不会发生任何事情。</p><h2 id="代码的运行情况"><a href="#代码的运行情况" class="headerlink" title="代码的运行情况"></a>代码的运行情况</h2><p>我们先在工作表中建立一个运行按钮，并关联上上述的“mynzC”过程，并在工作表中随便录入些数值、符号，之后在点击后会清除。如下图：</p><img src="https://pic1.zhimg.com/80/v2-925d864ca2b368bb98c1a31111b3affc_720w.jpg"><p>我们点击运行，会弹出下面的窗口：</p><img src="https://pic2.zhimg.com/80/v2-3316debf02a83efadb6a296696bb9c9d_720w.jpg"><p>我们选择“是”。</p><img src="https://pic1.zhimg.com/80/v2-c6f4a70ea9606bb084426f185aeb7770_720w.jpg"><p>这个时候的工作表就被清空了。</p><p>今日内容回想：<br>1） MsgBox函数的语法了解吗？<br>2） MsgBox函数在应用时分几部分？<br>3) 清空工作表是那句代码？</p><hr><h1 id="相关链接"><a href="#相关链接" class="headerlink" title="相关链接"></a>相关链接</h1><ol><li><a href="https://zhuanlan.zhihu.com/p/328608873">MsgBox函数的讲解及应用</a></li></ol><hr><center><font color="red">=================我是分割线=================</font></center><p><strong>欢迎到公众号来唠嗑:</strong></p><img src="https://pic4.zhimg.com/80/v2-eedc5dc7d30beedf4c2f1812df8e61a7_720w.jpg">]]></content>
    
    
    <summary type="html">MsgBox函数的讲解及应用</summary>
    
    
    
    <category term="编程类" scheme="https://zml3589110.github.io/categories/%E7%BC%96%E7%A8%8B%E7%B1%BB/"/>
    
    <category term="VBA" scheme="https://zml3589110.github.io/categories/%E7%BC%96%E7%A8%8B%E7%B1%BB/VBA/"/>
    
    <category term="前端" scheme="https://zml3589110.github.io/categories/%E5%89%8D%E7%AB%AF/"/>
    
    
    <category term="VBA" scheme="https://zml3589110.github.io/tags/VBA/"/>
    
    <category term="函数" scheme="https://zml3589110.github.io/tags/%E5%87%BD%E6%95%B0/"/>
    
    <category term="MsgBox" scheme="https://zml3589110.github.io/tags/MsgBox/"/>
    
  </entry>
  
  <entry>
    <title>在窗体中显示实时系统时钟</title>
    <link href="https://zml3589110.github.io/posts/2126489867.html"/>
    <id>https://zml3589110.github.io/posts/2126489867.html</id>
    <published>2022-06-28T00:26:20.000Z</published>
    <updated>2022-06-28T07:26:49.925Z</updated>
    
    <content type="html"><![CDATA[<h1 id="显示需求"><a href="#显示需求" class="headerlink" title="显示需求"></a>显示需求</h1><blockquote><p><strong>在使用用户窗体设计用户界面时，我们想要在适当的位置显示时钟，方便用户实时查看时间。</strong></p></blockquote><p>效果如图：</p><img src="https://ask.qcloudimg.com/http-save/yehe-5846058/wlpu7276os.gif"><h1 id="解决方式"><a href="#解决方式" class="headerlink" title="解决方式"></a>解决方式</h1><h2 id="1-先设置需要显示的模块"><a href="#1-先设置需要显示的模块" class="headerlink" title="1.先设置需要显示的模块"></a>1.先设置需要显示的模块</h2><p>放置了一个文本框控件（保留其默认名称 TextBox1 ），并在其中显示实时时间。</p><h2 id="2-在标准模块中添加代码"><a href="#2-在标准模块中添加代码" class="headerlink" title="2. 在标准模块中添加代码"></a>2. 在标准模块中添加代码</h2><p>设计好用户窗体界面后，在VBE中插入一个<strong>标准模块</strong>，输入下面的代码：</p><blockquote><p><strong>注意：一定要把这个程序放到模块之中，否则 Application.OnTime 这个函数会报错！</strong></p></blockquote><figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> StartTimer1()</span><br><span class="line">   Application.OnTime Now + TimeValue(<span class="string">&quot;00:00:01&quot;</span>),<span class="string">&quot;NextTick1&quot;</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">Sub</span> NextTick1()</span><br><span class="line">   UserForm1.TextBox1 = Format(Now, <span class="string">&quot;yyyy/mm/dd hh:mm:ss AM/PM&quot;</span>)</span><br><span class="line">   StartTimer1</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">Sub</span> StopTimer1()</span><br><span class="line">    <span class="keyword">On</span> ErrorResume <span class="keyword">Next</span></span><br><span class="line">   Application.OnTime Now + TimeValue(<span class="string">&quot;00:00:01&quot;</span>),<span class="string">&quot;NextTick1&quot;</span>, , <span class="literal">False</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure><h2 id="3-运行-NextTick1-函数即可"><a href="#3-运行-NextTick1-函数即可" class="headerlink" title="3. 运行 NextTick1 函数即可"></a>3. 运行 NextTick1 函数即可</h2><ul><li>运行NextTick1过程，然后显示用窗体，即可以看到显示实时时间的效果</li></ul><img src="https://ask.qcloudimg.com/http-save/yehe-5846058/gihxhe8vim.jpeg?imageView2/2/w/1620"><ul><li>也可以使用其他合适的控件，如标签控件</li></ul><img src="https://ask.qcloudimg.com/http-save/yehe-5846058/dp4og89mrm.gif"><ul><li>如果要停止时间的实时显示，运行StopTimer1过程即可。</li></ul><p>#其他方法</p><h2 id="方式一"><a href="#方式一" class="headerlink" title="方式一"></a>方式一</h2><p>方法同上在标准模块中使用Application.OnTime 函数，将Label1.caption更改为我的用户窗体上想要显示的适当标签。</p><figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> DisplayCurrentTime()</span><br><span class="line">    <span class="keyword">Dim</span> nextSecond <span class="keyword">As</span> <span class="type">Date</span></span><br><span class="line"></span><br><span class="line">    nextSecond = DateAdd(<span class="string">&quot;s&quot;</span>, <span class="number">1</span>, Now())</span><br><span class="line"></span><br><span class="line">    Label1.Caption = Time()</span><br><span class="line"></span><br><span class="line">    Application.OnTime _</span><br><span class="line">        Procedure:=<span class="string">&quot;DisplayCurrentTime&quot;</span>, _</span><br><span class="line">        EarliestTime:=nextSecond</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure><h2 id="方式二"><a href="#方式二" class="headerlink" title="方式二"></a>方式二</h2><blockquote><p><strong>要求：三个文本框分别放置系统时间的 时，分，秒，并随着时间变动而变动</strong></p></blockquote><p>放在模块中的函数：</p><figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> 时间()</span><br><span class="line"> UserForm1.TextBox1 = Left(Application.WorksheetFunction.<span class="keyword">Text</span>(Now(), <span class="string">&quot;HH:MM&quot;</span>), <span class="number">2</span>)</span><br><span class="line"> UserForm1.TextBox2 = Right(Application.WorksheetFunction.<span class="keyword">Text</span>(Now(), <span class="string">&quot;HH:MM&quot;</span>), <span class="number">2</span>)</span><br><span class="line"> UserForm1.TextBox3 = Right(Application.WorksheetFunction.<span class="keyword">Text</span>(Now(), <span class="string">&quot;MM:SS&quot;</span>), <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">Application.OnTime Now() + TimeValue(<span class="string">&quot;00:00:01&quot;</span>), <span class="string">&quot;时间&quot;</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Sub</span> 停止()</span><br><span class="line"> <span class="keyword">On</span> <span class="keyword">Error</span> <span class="keyword">Resume</span> <span class="keyword">Next</span></span><br><span class="line">Application.OnTime Now() + TimeValue(<span class="string">&quot;00:00:01&quot;</span>), <span class="string">&quot;时间&quot;</span>, , <span class="literal">False</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure><p>放在窗体中：</p><figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Private</span> <span class="keyword">Sub</span> CommandButton1_Click()</span><br><span class="line">    <span class="keyword">Call</span> 停止</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Private</span> <span class="keyword">Sub</span> CommandButton2_Click()</span><br><span class="line"><span class="keyword">Call</span> 时间</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Private</span> <span class="keyword">Sub</span> UserForm_Initialize()</span><br><span class="line">    <span class="keyword">Call</span> 时间</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure><p>放在启动中：</p><figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Private</span> <span class="keyword">Sub</span> Workbook_Open()</span><br><span class="line">     UserForm1.Show</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure><img src="https://raw.githubusercontent.com/zml3589110/MyImage/master/D:\Cache\PicGo\Github2.jpg"><img src="https://raw.githubusercontent.com/zml3589110/MyImage/master/D:\Cache\PicGo\Github1.gif"><p><a href="https://club.excelhome.net/forum.php?mod=attachment&aid=OTM1NzUzfGY1M2JlZTQ4fDE2NTU3OTQ4NTl8MHw3MjY4NzM=">时钟文件</a></p><hr><h1 id="相关链接"><a href="#相关链接" class="headerlink" title="相关链接"></a>相关链接</h1><ol><li><a href="https://cloud.tencent.com/developer/article/1785946">VBA实战技巧18：在用户窗体中显示时钟</a></li><li><a href="https://www.nuomiphp.com/eplan/4302.html">excel - VBA如何在用户窗体中显示实时时钟？</a></li><li><a href="https://club.excelhome.net/thread-726873-1-1.html">考试题目】在窗体文本框内实时显示系统时间</a></li></ol><hr><center><font color="red">=================我是分割线=================</font></center><p><strong>欢迎到公众号来唠嗑:</strong></p><img src="https://pic4.zhimg.com/80/v2-eedc5dc7d30beedf4c2f1812df8e61a7_720w.jpg">]]></content>
    
    
    <summary type="html">在窗体中显示实时系统时钟，方便用户实时查看时间</summary>
    
    
    
    <category term="编程类" scheme="https://zml3589110.github.io/categories/%E7%BC%96%E7%A8%8B%E7%B1%BB/"/>
    
    <category term="VBA" scheme="https://zml3589110.github.io/categories/%E7%BC%96%E7%A8%8B%E7%B1%BB/VBA/"/>
    
    <category term="前端" scheme="https://zml3589110.github.io/categories/%E5%89%8D%E7%AB%AF/"/>
    
    
    <category term="VBA" scheme="https://zml3589110.github.io/tags/VBA/"/>
    
    <category term="显示" scheme="https://zml3589110.github.io/tags/%E6%98%BE%E7%A4%BA/"/>
    
    <category term="时间" scheme="https://zml3589110.github.io/tags/%E6%97%B6%E9%97%B4/"/>
    
  </entry>
  
  <entry>
    <title>搭建个人图床(PicGo + GitHub)</title>
    <link href="https://zml3589110.github.io/posts/3258321867.html"/>
    <id>https://zml3589110.github.io/posts/3258321867.html</id>
    <published>2022-06-20T01:10:20.000Z</published>
    <updated>2022-06-20T01:55:21.286Z</updated>
    
    <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><blockquote><p><strong>这个方式来取代 七牛云+Mpic 方案</strong><br>我以前用的 七牛云 + Mpic 的组合，后来由于七牛云测试域名收回，我的图床就废了。以前的好多图片都埋藏在七牛云的服务器上，又气又难过。思考好一段时间，想自己搭服务，但成本有点高，备案的域名 + 服务器一年几百块。对于我这种不靠写字谋生的人而言没有必要，所以就停摆了一段时间。直到今天用 GitHub 搭起了图床，可以说非常开心了。所以跟大家分享一下。</p></blockquote><ul><li>该软件使用手册：<a href="https://picgo.github.io/PicGo-Doc/zh/guide/#%E5%BA%94%E7%94%A8%E8%AF%B4%E6%98%8E">https://picgo.github.io/PicGo-Doc/zh/guide/#应用说明</a></li></ul><h1 id="一、下载-x2F-安装"><a href="#一、下载-x2F-安装" class="headerlink" title="一、下载&#x2F;安装"></a>一、下载&#x2F;安装</h1><ol><li>下载链接</li></ol><blockquote><p>PicGo （目前 2.0.4）是一个开源的图床工具，非常优秀。可以到 git 上下载，但下载速度太慢，所以我放了一个百度云的链接，速度快很多</p></blockquote><p>参考文档提供: Win版下载链接：<a href="https://pan.baidu.com/share/init?surl=7KycPMoqNCnc1cR_yQO8nQ">百度云</a> 密码：PicG</p><p>git地址：<a href="https://github.com/Molunerfinn/PicGo/releases">PicGo</a></p><img src="https://img-blog.csdnimg.cn/1748132cebc0432a958938d33e8d917b.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5oiR5oOz5YW75Y-q5rGk5aeG54yr,size_20,color_FFFFFF,t_70,g_se,x_16"><p><strong>下载后一路点安装即可</strong></p><ol start="2"><li>配置<blockquote><p><strong>仅使用 GitHub 做图床，所以 PicGo 设置仅选择GitHub图床</strong></p></blockquote></li></ol><img src="https://img-blog.csdnimg.cn/4280cca5c8dd47b799e89332ff72d9ec.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5oiR5oOz5YW75Y-q5rGk5aeG54yr,size_20,color_FFFFFF,t_70,g_se,x_16"><h1 id="GitHub-仓库设置"><a href="#GitHub-仓库设置" class="headerlink" title="GitHub 仓库设置"></a>GitHub 仓库设置</h1><blockquote><p><strong>流程：新建 public 仓库 -&gt; 创建 token -&gt; 复制 token 备用</strong></p></blockquote><ol><li>新建仓库</li></ol><p>点击 git 主页右上角的 + 创建 New repository；</p><img src="https://img-blog.csdnimg.cn/be35fc1137e64b09bd62dcaa382926c1.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5oiR5oOz5YW75Y-q5rGk5aeG54yr,size_20,color_FFFFFF,t_70,g_se,x_16"><p>填写仓库信息，例如我就创建了一个 cloudimg 的仓库。这里注意，仓库得设置为 Public 因为后面通过客户端访问算是外部访问，因此无法访问 Private ，这样的话图片传上来之后只能存储不能显示。所以要设置为 Public。</p><p>图一：</p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL3llZmNpb24vUGljRGF0YS9tYXN0ZXIvaW1nLzIwMTkwMzExMjIyNTE0LnBuZw"><p>图二：</p><img src="https://img-blog.csdnimg.cn/7db3e15ac0e5460fa29e1f7e080689f7.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5oiR5oOz5YW75Y-q5rGk5aeG54yr,size_20,color_FFFFFF,t_70,g_se,x_16"><ol start="2"><li>创建 token 并复制保存</li></ol><p>此时仓库已经建立，点击右上角头像，然后进入设置:</p><img src="https://img-blog.csdnimg.cn/5cef567c46634a14947158625fb5f0f2.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5oiR5oOz5YW75Y-q5rGk5aeG54yr,size_20,color_FFFFFF,t_70,g_se,x_16"><p>在页面最下找到 Developer settings，点击进入:</p><img src="https://img-blog.csdnimg.cn/b7e9dfe38ee14ebfb8a13c02398e853b.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5oiR5oOz5YW75Y-q5rGk5aeG54yr,size_20,color_FFFFFF,t_70,g_se,x_16"><p>创建 token:</p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL3llZmNpb24vUGljRGF0YS9tYXN0ZXIvaW1nLzIwMTkwMzExMjIzMzE3LnBuZw?x-oss-process=image/format,png"><p>填 description（也是随心填），勾选复选框 repo ，接着到页面底部 Generate token 就完成了：</p><p>设置一、</p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL3llZmNpb24vUGljRGF0YS9tYXN0ZXIvaW1nLzE1NTIzMTQ5MDc3OTQucG5n?x-oss-process=image/format,png"><p>设置二、</p><img src="https://img-blog.csdnimg.cn/5b38543cd03b4418980b586628222fe7.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5oiR5oOz5YW75Y-q5rGk5aeG54yr,size_20,color_FFFFFF,t_70,g_se,x_16"><ol start="3"><li>然后复制生成一串字符 token，这个 token 只出现一次，所以要保存一下（我一般记在微信收藏）</li></ol><blockquote><ul><li>点击生成之后Token只会出现一次，记得保存备用</li></ul></blockquote><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL3llZmNpb24vUGljRGF0YS9tYXN0ZXIvaW1nLzIwMTkwMzExMjIzOTAxLnBuZw"><h1 id="在PicGo中设置Github图库"><a href="#在PicGo中设置Github图库" class="headerlink" title="在PicGo中设置Github图库"></a>在PicGo中设置Github图库</h1><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL3llZmNpb24vUGljRGF0YS9tYXN0ZXIvaW1nLzIwMTkwMzExMjI0NDQzLnBuZw"><ul><li>仓库名 即你的仓库名（你的Github账户名&#x2F;刚才创建的仓库名）</li><li>分支名 默认 master</li><li>Token 就是刚刚从github复制的那一串字符</li><li>存储路径 这个可以填也可以不填，填了的话图片就上传到 git 中 data 这个文件夹</li><li>域名 <a href="https://raw.githubusercontent.com/yefcion/cloudimg/master%E8%BF%99%E4%B8%AA%E8%A6%81%E6%94%B9%E4%B8%80%E4%B8%8B">https://raw.githubusercontent.com/yefcion/cloudimg/master这个要改一下</a> 格式 <a href="https://raw.githubusercontent.com/[username]/[%E4%BB%93%E5%BA%93%E5%90%8D]/master">https://raw.githubusercontent.com/[username]/[仓库名]/master</a></li><li>自定义域名的作用是，在上传图片后成功后，PicGo会将“自定义域名+上传的图片名”生成的访问链接，放到剪切板上<a href="https://raw.githubusercontent.com/%E7%94%A8%E6%88%B7%E5%90%8D/RepositoryName/%E5%88%86%E6%94%AF%E5%90%8D%EF%BC%8C%EF%BC%8C%E8%87%AA%E5%AE%9A%E4%B9%89%E5%9F%9F%E5%90%8D%E5%8F%AF%E6%8C%89%E6%AD%A4%E5%A1%AB%E5%86%99%E3%80%82">https://raw.githubusercontent.com/用户名/RepositoryName/分支名，，自定义域名可按此填写。</a></li></ul><blockquote><p>**注：这里提供一个加速访问图片的方法：CDN加速，具体原理自行百度（我还不是很懂）<br>将上面的域名改为：<br>原 <a href="https://raw.githubusercontent.com/yefcion/cloudimg/master">https://raw.githubusercontent.com/yefcion/cloudimg/master</a><br>现 <a href="https://cdn.jsdelivr.net/gh/yefcion/cloudimg@master">https://cdn.jsdelivr.net/gh/yefcion/cloudimg@master</a><br>**</p></blockquote><p>然后点确定就可以了。</p><h1 id="接下来就可以正常使用了"><a href="#接下来就可以正常使用了" class="headerlink" title="接下来就可以正常使用了"></a>接下来就可以正常使用了</h1><ul><li><p>我们将图片复制到剪切板中，按我们所设置的快捷键，图片将自动上传到我们Github的仓库中</p></li><li><p>根据自己之前所选择的格式，图片的链接会自动复制到我们的剪切板中，等到图片上传完毕之后，我们直接Ctrl +V就好了</p></li><li><p>然后关于上传的快捷键设置。默认的是 Mac 按键，推荐改成 Ctrl + alt +c。</p></li></ul><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL3llZmNpb24vUGljRGF0YS9tYXN0ZXIvaW1nLzIwMTkwMzExMjI0OTM1LnBuZw"><p>Typora软件和PicGo配合起来使用更佳，使用typora写完博客然后直接导入CSDN的编辑器中，真香</p><p><strong>本方案唯一缺点，不能私人。但是考虑到 GitHub 上传的图在列表里没法预览，应该没人会闲着没事翻记录。</strong></p><hr><blockquote><p><strong>说明：本文是收集参考网络文档，以方便查看</strong></p></blockquote><hr><h1 id="信息链接"><a href="#信息链接" class="headerlink" title="信息链接:"></a>信息链接:</h1><ol><li><a href="https://blog.csdn.net/yefcion/article/details/88412025">PicGo + GitHub 搭建个人图床工具</a></li><li><a href="https://blog.csdn.net/qq_43367829/article/details/104882071">PicGo+GitHub使用</a></li></ol><hr><center><font color="red">=================我是分割线=================</font></center><p><strong>欢迎到公众号来唠嗑:</strong></p><img src="https://pic4.zhimg.com/80/v2-eedc5dc7d30beedf4c2f1812df8e61a7_720w.jpg">]]></content>
    
    
    <summary type="html">使用 PicGo 和 GitHub 搭建属于自己的个人图床，预防使用网络图床导致链接失败</summary>
    
    
    
    <category term="编程类" scheme="https://zml3589110.github.io/categories/%E7%BC%96%E7%A8%8B%E7%B1%BB/"/>
    
    <category term="GitHub" scheme="https://zml3589110.github.io/categories/%E7%BC%96%E7%A8%8B%E7%B1%BB/GitHub/"/>
    
    <category term="PicGo" scheme="https://zml3589110.github.io/categories/PicGo/"/>
    
    
    <category term="图床" scheme="https://zml3589110.github.io/tags/%E5%9B%BE%E5%BA%8A/"/>
    
    <category term="PicGo" scheme="https://zml3589110.github.io/tags/PicGo/"/>
    
    <category term="GitHub" scheme="https://zml3589110.github.io/tags/GitHub/"/>
    
  </entry>
  
  <entry>
    <title>VScode配置KEIL5编译下载</title>
    <link href="https://zml3589110.github.io/posts/3493436520.html"/>
    <id>https://zml3589110.github.io/posts/3493436520.html</id>
    <published>2022-06-18T07:55:20.000Z</published>
    <updated>2022-06-18T08:16:52.349Z</updated>
    
    <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>经常使用keil的人都知道keil的使用特别广泛，但是keil的自动补全功能极其难用。VScode功能十分强大，许多大佬为其编写插件供他人使用，利用好这些插件可以大大提高代码编写效率。最近发现了一个VScode可以调用KEIL编程的插件，使用起来非常方便。</p><h1 id="一、安装插件"><a href="#一、安装插件" class="headerlink" title="一、安装插件"></a>一、安装插件</h1><ol><li>点击拓展选项的图标</li></ol><img src="https://i0.hdslb.com/bfs/article/ee3c30d0c52a663e79e077f3abc93b8dc1f4f2a1.png@174w_107h_progressive.webp"><blockquote><p><strong>输入Chinese，进行安装，安装完成后界面就变成中文了。</strong></p></blockquote><img src="https://i0.hdslb.com/bfs/article/8781454b3adba17079f688b931915f584e8d9f46.png@942w_699h_progressive.webp"><ol start="2"><li>VScode中搜索插件Keil Assistant并安装。</li></ol><img src="https://img-blog.csdnimg.cn/20210717213624458.png"><h1 id="二、使用方法"><a href="#二、使用方法" class="headerlink" title="二、使用方法"></a>二、使用方法</h1><blockquote><p>插件下方介绍非常详细，并且都是中文的。</p></blockquote><img src="https://img-blog.csdnimg.cn/20210717213828397.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDAxMjM1OQ==,size_16,color_FFFFFF,t_70"><ol><li>插件设置<blockquote><p>进入插件设置，添加Keil可执行文件的路径</p></blockquote></li></ol><img src="https://img-blog.csdnimg.cn/20210717214251906.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDAxMjM1OQ==,size_16,color_FFFFFF,t_70"><blockquote><p>如下图所示第一个是51单片机的路径，第二个选项是MDK的路径（也就是ARM核单片机的路径）</p></blockquote><img src="https://i0.hdslb.com/bfs/article/1372396b3c92e211ab8a538136e310a3b73688cf.png@942w_704h_progressive.webp"><blockquote><p>接下来就是填入路径，找到我们的keil软件选着文件所在位置</p></blockquote><img src="https://i0.hdslb.com/bfs/article/09bc99e665e38b29bb814e5deeb07277b93f6ac5.png@470w_938h_progressive.webp"><p>在安装位置找到 keil 的图标:</p><img src="https://i0.hdslb.com/bfs/article/2aa130c7fed5bebbbd3a922e39fd6e63474844bb.png@942w_548h_progressive.webp"><p>复制他的路径:</p><img src="https://i0.hdslb.com/bfs/article/3e288ef2cef0c3855e558e4890dca034ab682250.png@942w_45h_progressive.webp"><p>填入VScode(注意：要在刚才的路径后面添加UV4.exe的后缀):</p><img src="https://i0.hdslb.com/bfs/article/730c29528eef3c4c9aa5baf7eb9dc60146d553b7.png@939w_483h_progressive.webp"><p>至此Keil Assistant配置完成。注意我在keil 5中安装了51单片机的包，所以路径相同，实测若是安装keil 4如此添加路径是没有用的，所以要用他来写51单片机的需要安装keil 5的51的包。</p><ol start="2"><li>打开工程</li></ol><p>打开资源管理器，会出现KEIL UVISION PROJECT点击后面的打开keil工程按钮，选择你想打开的工程的**.uvprojx**文件。</p><img src="https://img-blog.csdnimg.cn/20210717214649138.png"><p><strong>下方会有编译，下载，重编译按钮。</strong></p><img src="https://img-blog.csdnimg.cn/20210717214748979.png"><h1 id="三、配置工程"><a href="#三、配置工程" class="headerlink" title="三、配置工程"></a>三、配置工程</h1><blockquote><p><strong>VScode打开keil工程会出现工程头文件、变量红色波浪线的情况，通过配置工程，可以解决问题。如果不想改的话，也可以不改。</strong></p></blockquote><ol><li>配置方法</li></ol><p>按ctrl+alt+P在搜索栏中搜索Edit configurations (UI)。</p><img src="https://img-blog.csdnimg.cn/20210717215342533.png"><p>进入配置界面，里面都是中文，仔细阅读可以理解。</p><img src="https://img-blog.csdnimg.cn/20210717215535865.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDAxMjM1OQ==,size_16,color_FFFFFF,t_70"><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><blockquote><p><strong>利用此插件便可以通过VScode调用KEIL编写代码。<br>最后推荐一个可以提高工程逼格的插件koroFileHeader<br>文件头注释模板，安装步骤同上，文件头内容可在插件配置中更改，并更新最后修改时间。<br>快捷键：ctrl+alt+i</strong></p></blockquote><img src="https://img-blog.csdnimg.cn/2021071722393639.png"><img src="https://img-blog.csdnimg.cn/2021071722394671.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDAxMjM1OQ==,size_16,color_FFFFFF,t_70"><blockquote><p>打开工程后注释乱码怎么解决:<br><strong>调整vscode的编码方式 和你的keil相同 一般为GB2312</strong></p></blockquote><p>VScode作为一款功能强大的文本编辑器它可以用来写任何的语言，有多种拓展可以供你来安装使用。它来写单片机是因为他的代码高亮、跳转、代码自动补全非常好用。比keil不知好用多少倍。但是若你要是调试单片机的话还是建议用keil（术业有专攻）仅仅将VScode作为一个文本编辑器来使用。使用时同时开启VScode和keil。用VScode来写代码，用keil进行调试。不要担心你在VScode中写的代码保存后会自动同步过去的，keil 中也是如此！</p><hr><blockquote><p><strong>说明：本文是收集参考网络文档，以方便查看</strong></p></blockquote><hr><h1 id="信息链接"><a href="#信息链接" class="headerlink" title="信息链接:"></a>信息链接:</h1><ol><li><a href="https://blog.csdn.net/weixin_44012359/article/details/118862954">VScode调用KEIL-MDK</a></li><li><a href="https://www.bilibili.com/read/cv14597116">VScode 配置 keil 5 环境</a></li></ol><hr><center><font color="red">=================我是分割线=================</font></center><p><strong>欢迎到公众号来唠嗑:</strong></p><img src="https://pic4.zhimg.com/80/v2-eedc5dc7d30beedf4c2f1812df8e61a7_720w.jpg">]]></content>
    
    
    <summary type="html">通过 VScode 插件 Keil Assistant 连接 KEIL 进行编译下载</summary>
    
    
    
    <category term="编程类" scheme="https://zml3589110.github.io/categories/%E7%BC%96%E7%A8%8B%E7%B1%BB/"/>
    
    <category term="KEIL" scheme="https://zml3589110.github.io/categories/%E7%BC%96%E7%A8%8B%E7%B1%BB/KEIL/"/>
    
    <category term="VScode" scheme="https://zml3589110.github.io/categories/VScode/"/>
    
    
    <category term="KEIL5" scheme="https://zml3589110.github.io/tags/KEIL5/"/>
    
    <category term="VScode" scheme="https://zml3589110.github.io/tags/VScode/"/>
    
    <category term="环境配置" scheme="https://zml3589110.github.io/tags/%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/"/>
    
    <category term="Keil Assistant" scheme="https://zml3589110.github.io/tags/Keil-Assistant/"/>
    
  </entry>
  
  <entry>
    <title>KEIL5安装C51依赖</title>
    <link href="https://zml3589110.github.io/posts/2938783249.html"/>
    <id>https://zml3589110.github.io/posts/2938783249.html</id>
    <published>2022-06-18T07:34:20.000Z</published>
    <updated>2022-06-18T08:16:52.347Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>**问题描述：从KEIL4升级安装了KEIL5之后找不到 C51 相关设置，想创建89C51的工程却发现找不到89C51的芯片包 **</p></blockquote><h1 id="无法创建的原因"><a href="#无法创建的原因" class="headerlink" title="无法创建的原因"></a>无法创建的原因</h1><p>keil4通常用来开发51单片机项目，而keil5通常用来开发STM32项目，keil5中默认并没有51芯片库，这就导致了keil5创建工程时找不到89C51芯片。就像下图这样只有ARM和STM系列芯片。</p><img src="https://img-blog.csdnimg.cn/20210606213725369.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzcyMTE2Mw==,size_16,color_FFFFFF,t_70"><p><strong>真正原因在与keil5没有如下包（Legacy Device Database [no RTE]），如图:</strong></p><img src="https://img-blog.csdnimg.cn/20210606213852524.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzcyMTE2Mw==,size_16,color_FFFFFF,t_70"><h1 id="解决步骤"><a href="#解决步骤" class="headerlink" title="解决步骤"></a>解决步骤</h1><blockquote><p><strong>解决思路：使keil5集成51芯片库</strong></p></blockquote><ol><li><p>首先我们找到51芯片库的下载地址，去官网下载即可。<br>下载地址： <a href="https://www.keil.com/download/product/">https://www.keil.com/download/product/</a></p></li><li><p>进入官网后点击C51</p></li></ol><img src="https://img-blog.csdnimg.cn/20210606214158601.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzcyMTE2Mw==,size_16,color_FFFFFF,t_70"><p><strong>进去后需要填写一下个人信息，我们看情况填写就行了。</strong></p><ol start="3"><li>点击这个C51V960A.EXE下载安装51芯片库</li></ol><img src="https://img-blog.csdnimg.cn/20210606214424233.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzcyMTE2Mw==,size_16,color_FFFFFF,t_70"><blockquote><p>下载完成后以管理员身份运行，点击 <strong>next</strong></p></blockquote><img src="https://img-blog.csdnimg.cn/20210606214650227.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzcyMTE2Mw==,size_16,color_FFFFFF,t_70"> <p>下一步确认自己keil5的根目录（一般默认是没问题的），Backup打勾后点击next</p><img src="https://img-blog.csdnimg.cn/20210606214813818.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzcyMTE2Mw==,size_16,color_FFFFFF,t_70"><p>下一步看情况填写:</p><p>&lt;src&#x3D;”<a href="https://img-blog.csdnimg.cn/20210606214844648.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzcyMTE2Mw==,size_16,color_FFFFFF,t_70&quot;&gt;">https://img-blog.csdnimg.cn/20210606214844648.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzcyMTE2Mw==,size_16,color_FFFFFF,t_70&quot;&gt;</a></p><p>然后点击next等待安装完成即可。注意安装前要关闭当前正在运行的keil5</p><ol start="4"><li>再次打开keil5创建工程</li></ol><p>点击project&gt;New xxxxxx创建工程，下拉菜单就出现了51单片机的芯片库</p><img src="https://img-blog.csdnimg.cn/20210606215219879.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzcyMTE2Mw==,size_16,color_FFFFFF,t_70"><p>选中后可以直接在搜索框搜索AT89C51，或者找到Microchip展开第一个就是</p><img src="https://img-blog.csdnimg.cn/20210606215423315.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzcyMTE2Mw==,size_16,color_FFFFFF,t_70"><p>点击OK之后51工程就创建成功了。</p><hr><blockquote><p><strong>说明：本文是收集参考网络文档，以方便查看</strong></p></blockquote><hr><h1 id="信息链接"><a href="#信息链接" class="headerlink" title="信息链接:"></a>信息链接:</h1><ol><li><a href="https://blog.csdn.net/weixin_43721163/article/details/117637028">KEIL5安装C51依赖，解决KEIL5无法创建C51工程</a></li></ol><hr><center><font color="red">=================我是分割线=================</font></center><p><strong>欢迎到公众号来唠嗑:</strong></p><img src="https://pic4.zhimg.com/80/v2-eedc5dc7d30beedf4c2f1812df8e61a7_720w.jpg">]]></content>
    
    
    <summary type="html">为 KEIL5 安装 C51 依赖包</summary>
    
    
    
    <category term="编程类" scheme="https://zml3589110.github.io/categories/%E7%BC%96%E7%A8%8B%E7%B1%BB/"/>
    
    <category term="KEIL" scheme="https://zml3589110.github.io/categories/%E7%BC%96%E7%A8%8B%E7%B1%BB/KEIL/"/>
    
    
    <category term="KEIL5" scheme="https://zml3589110.github.io/tags/KEIL5/"/>
    
    <category term="C51" scheme="https://zml3589110.github.io/tags/C51/"/>
    
  </entry>
  
  <entry>
    <title>马自达钥匙技巧等</title>
    <link href="https://zml3589110.github.io/posts/264219034.html"/>
    <id>https://zml3589110.github.io/posts/264219034.html</id>
    <published>2022-06-10T06:27:20.000Z</published>
    <updated>2022-06-10T07:03:27.262Z</updated>
    
    <content type="html"><![CDATA[<h1 id="钥匙中止功能，很多老司机也不一定知道！"><a href="#钥匙中止功能，很多老司机也不一定知道！" class="headerlink" title="钥匙中止功能，很多老司机也不一定知道！"></a>钥匙中止功能，很多老司机也不一定知道！</h1><img src="https://mmbiz.qpic.cn/mmbiz_gif/WCGkgwxeBkxSMib8cPxONAUfJ22d1t34bBIxSWp437SeAhZadk5AVNqGdIk9G5BbRTOOsGPjvtVdwIkx2fictbIw/640?wx_fmt=gif&wxfrom=5&wx_lazy=1"><h2 id="钥匙中止功能的作用"><a href="#钥匙中止功能的作用" class="headerlink" title="钥匙中止功能的作用"></a>钥匙中止功能的作用</h2><blockquote><p>当车辆防盗系统检测到钥匙被遗落在车厢或后备箱后，钥匙中止功能会被激活。此时留在车内的钥匙功能会被临时性中止，导致无法启动发动机，从而降低车辆被盗风险。</p></blockquote><img src="https://mmbiz.qpic.cn/mmbiz_jpg/WCGkgwxeBkxSMib8cPxONAUfJ22d1t34bEcMkYUsGMJ8byhVL7icoo6GkZOUpEwicsZTgP4OcKhlK0Oodf9ofLZibw/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1&wx_co=1"><h2 id="钥匙中止功能的触发场景"><a href="#钥匙中止功能的触发场景" class="headerlink" title="钥匙中止功能的触发场景"></a>钥匙中止功能的触发场景</h2><ul><li>带高级遥控功能的钥匙，会在以下两种情况触发钥匙中止功能：<blockquote><p>所有车门被上锁，钥匙留在后备箱内且后备箱门关闭<br>在这种情况下，可以通过按下电子开启装置的方式打开后备箱并取出钥匙，但取出的钥匙功能会暂时停止。</p></blockquote></li></ul><img src="https://mmbiz.qpic.cn/mmbiz_jpg/WCGkgwxeBkxSMib8cPxONAUfJ22d1t34bfEN7hAic99GsU2CNbVBUqVXZ6RTZJic9ZRvmPibibJjjibzf4us5xuATcfg/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1&wx_co=1"><ul><li>钥匙留在车厢内时，使用另外一把钥匙使所有车门和后备箱上锁<br>在这种情况下，打开车门取出钥匙后，其功能会暂时停止。</li></ul><img src="https://mmbiz.qpic.cn/mmbiz_jpg/WCGkgwxeBkxSMib8cPxONAUfJ22d1t34bBEc7Iic3WfhCvfUnvGiaoCcSJbFrP0K3Plu3ZQkzn0ga1pAkab1XNCHw/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1&wx_co=1"><p><strong>注：以上两种情况发生时，车辆都会发出约 10 秒的蜂鸣声，以通知驾驶员钥匙遗留在车内。</strong></p><h2 id="如何解除钥匙中止功能"><a href="#如何解除钥匙中止功能" class="headerlink" title="如何解除钥匙中止功能"></a>如何解除钥匙中止功能</h2><blockquote><p>取回遗留在车内的钥匙后，只需在车内按下钥匙的开锁按钮便可解除钥匙中止功能，解除后发动机便可启动。</p></blockquote><img src="https://mmbiz.qpic.cn/mmbiz_jpg/WCGkgwxeBkxSMib8cPxONAUfJ22d1t34b5N1Xe2eFefyg8GCNLGicvI5SCQzgCKsoJjibicsbz8icwH2wk87UpPaLlQ/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1&wx_co=1"><h1 id="优秀评论："><a href="#优秀评论：" class="headerlink" title="优秀评论："></a>优秀评论：</h1><h2 id="长按开锁键5-6秒，然后四窗就会自动下降"><a href="#长按开锁键5-6秒，然后四窗就会自动下降" class="headerlink" title="长按开锁键5-6秒，然后四窗就会自动下降"></a>长按开锁键5-6秒，然后四窗就会自动下降</h2><p>在生活中，我想大家都遇到过这样一种烦恼，比如车中后排坐了人，然后人都习惯性的下去了，车子也熄火了，准备离开时却发现后排车窗没关。这时又要重新开启车的电源关闭车窗好麻烦啊！<br>但是马自达却又这样的冷门又实用的功能:拿起车钥匙，长按开锁键5-6秒，然后四窗就会自动下降。长按钥匙关闭键5-6秒，然后你会发现四门又奇迹般升上去了。其实还有一个更冷门的功能，有兴趣的试一下:锁-解锁-锁(不用开电源)四门车窗会开一条缝，但是好像没什么卵用。不知道厂家的意图。发现之后，带女朋友或者撩妹子时对着车门用四窗智能升降法再加上马自达的颜值，妹子一定会刮目相看，逼格提升不少呢～</p><h2 id="触摸板点击停放音乐，驾驶位置的钥匙记忆功能"><a href="#触摸板点击停放音乐，驾驶位置的钥匙记忆功能" class="headerlink" title="触摸板点击停放音乐，驾驶位置的钥匙记忆功能"></a>触摸板点击停放音乐，驾驶位置的钥匙记忆功能</h2><p>我都想给大家来个视频教学 给大家展现一下我们小昂的隐藏功能到底有哪些[旺柴]<br>首先就是触控板，设置<del>系统设置</del>触控板~勾选，然后这个触控板就可以单击暂停音乐，双击下一首音乐，方便又好玩[旺柴]<br>还有一个就是钥匙记忆功能，当我们调整到适合自己的驾驶位置跟后视镜后，按住set键，听到滴的一声响后拿出车钥匙按下解锁键，钥匙记忆功能就设置成功了[鼓掌]之后不管位置怎么调，只要我拿着设置过的钥匙解锁打开车门，都会重新调整到我自己的位置上！[旺柴]牛不牛🐮<br>总之 只要夸马自达的我们就是好朋友👬</p><h2 id="中控黑屏重启"><a href="#中控黑屏重启" class="headerlink" title="中控黑屏重启"></a>中控黑屏重启</h2><p>我们都知道有的导航会在使用时突然死机或者黑屏，然后就不知道怎么办，很麻烦！要是在高速死机黑屏真的对于不认识路又靠车上导航的人来说要哭了。马自达针对这个有特殊设计的！在中控台有几个功能键，同时长按音乐键和最右的导航键可以重启。</p><h2 id="保养提醒关闭"><a href="#保养提醒关闭" class="headerlink" title="保养提醒关闭"></a>保养提醒关闭</h2><p>马三车主报道，保养将至的时候只要开车总会跳出来提示，这个时候可以将大圆旋钮往左一掰，就可以取消了，不过不要忘记按时去保养哦[转圈]</p><h2 id="车钥匙控制升降窗户，自动启停不用关"><a href="#车钥匙控制升降窗户，自动启停不用关" class="headerlink" title="车钥匙控制升降窗户，自动启停不用关"></a>车钥匙控制升降窗户，自动启停不用关</h2><p>杠五黑骑士车主报道，分享两个很有用但大多数车主不知道的小技巧。一是车钥匙控制升降窗户。长按钥匙锁车键，可以自动升窗；长按钥匙解锁键，可以自动降窗，升降幅度以按钥匙时长随心控制，夏天散热必备神器，优雅降温！二是自动启停不用关。轻踩刹车刹住后，istop灯闪烁，松开刹车，车停住了，但是不会熄火，如果需要熄火再深踩一脚刹车即可。如果需要直接熄火可以直接重踩刹车。</p><h2 id="安全带高度调节，后排座椅放倒"><a href="#安全带高度调节，后排座椅放倒" class="headerlink" title="安全带高度调节，后排座椅放倒"></a>安全带高度调节，后排座椅放倒</h2><p>1、安全带高度可手动调节。<br>2、按两下锁车键可以寻车。<br>3、长按开锁按键，所有车窗和天窗同时打开。长按锁车按键，所有车窗和天窗关闭。<br>4、钥匙没电时，可以拔出机械钥匙打开车门，把有马自达车标的地方贴在一键启动按钮上，即可识别车钥匙打火。<br>5、汽车行驶中落锁功能可在汽车电脑的设置中设置。<br>6、汽车后排座椅可放倒，可应急使用，以及用来休息。</p><h2 id="儿童锁功能开启方式"><a href="#儿童锁功能开启方式" class="headerlink" title="儿童锁功能开启方式"></a>儿童锁功能开启方式</h2><p>“儿童锁”这个功能设置的非常好，打开此功能后，后排车门只能从车外打开，可以避免发生一些意外，保障后排儿童的安全。具体操作位置在后排副驾一侧的门上，有一个小圆孔，通过旋转孔内的小孔槽，即可开启&#x2F;关闭儿童锁。</p><h2 id="行车落锁功能"><a href="#行车落锁功能" class="headerlink" title="行车落锁功能"></a>行车落锁功能</h2><p>行车落锁🔒 可以进行手工设置和悦联系统设置。<br>下面是手工设置方法哦！<br>自动落锁5种模式先选好其中一个。<br>1：自动车门上锁功能将失效。<br>2：当车速为20km&#x2F;h或更高时速，则所有车门和后舱门将自动上锁。<br>3：出厂设定，当车速为20km&#x2F;h或更高时速，则所有车门和后备舱门将自动上锁。当点火开关从ON切换至OFF位置时，所有车门和后舱门将开锁。<br>4：当点火开关切换至ON且换挡杆从驻车档（P）切换至其它档位时，所有车门和后舱门将自动上锁。<br>5：当点火开关切换至ON且换挡杆从驻车档（P）切换至其它档位时，所有车门和后舱门将自动上锁。当点火开关切换至ON且换挡杆从驻车档（P）切换至其它档位时，所有车门和后舱门将自动开锁。<br>操作方法：<br>1.安全停放车辆所有车门必须关闭状态<br>2.将点火开关切换至on档<br>3.将点火开关切换至on档20秒钟内按住驾驶员车门门锁开关上的锁侧，然后约8秒钟后应听到哗的一声。<br>4.按下车门门锁开锁侧，所按次数与选择功能编号相同即可。<br>5.变更功能设定后三秒钟，将根据所选的功能编号，蜂鸣器响声几次。</p><h2 id="方向盘锁死"><a href="#方向盘锁死" class="headerlink" title="方向盘锁死"></a>方向盘锁死</h2><p>方向盘锁死，点不着火，按发动，灯闪烁后就不再反应。这时，需要将钥匙靠近启动按钮，同时手抓牢方向盘，点击启动的同时稍用力转动方向盘即可解锁。之前昂克赛拉发生过几次，用此方法屡试不爽</p><h2 id="重启系统，倒车静音，显示时间"><a href="#重启系统，倒车静音，显示时间" class="headerlink" title="重启系统，倒车静音，显示时间"></a>重启系统，倒车静音，显示时间</h2><p>MZD CONNECT马自达悦联系统懂你又贴心，自带 “隐形”重启按钮，只要将“音乐键”与“导航键”同时按下3秒，即可优雅的将死机的系统重启，而不必停车熄火再着车这些繁琐举动。<br>贴心的并不仅在重启按钮上，人性化方面也做到了细致的考虑。倒车时如果音响声音过大影响倒车雷达蜂鸣警告音的收听，可在车辆静止状态短按指挥键声音旋钮，使音响静音，不影响倒车雷达蜂鸣警告音的收听。<br>除此之外，悦联系统还可变身成为一台数字时钟，只需长按3秒音量旋钮就会关闭悦联系统，只显示时间。</p><h2 id="遥控钥匙匹配座椅-设置迎宾模式"><a href="#遥控钥匙匹配座椅-设置迎宾模式" class="headerlink" title="遥控钥匙匹配座椅,设置迎宾模式"></a>遥控钥匙匹配座椅,设置迎宾模式</h2><p>遥控钥匙匹配座椅，设置迎宾模式。首先将座椅调至合适上车位置，按遥控钥匙的解锁键，此时座椅默认为遥控钥匙1上车位置，然后将座椅调至合适驾驶位置，按设置并确认1位置，这样就设置了主驾驶迎宾模式。下次开车门主驾座椅就会自动调整到合适上车位置，到了驾驶位后按1，自动调整到驾驶位置。如有不正确，请指教</p><h2 id="马三天窗透气模式"><a href="#马三天窗透气模式" class="headerlink" title="马三天窗透气模式"></a>马三天窗透气模式</h2><p>昨天在抖音刷到马自达的视频，才知道原来马三的天窗按键往前面推是天窗透气的模式[捂脸][捂脸]</p><h2 id="自适应智能大灯"><a href="#自适应智能大灯" class="headerlink" title="自适应智能大灯"></a>自适应智能大灯</h2><p>很贴心的自适应智能大灯<br>细心的马自达车主会发现，大灯会自动调节高度，它会根据坐上的人调节，是不是很智能。如果感觉不到的车主，可以把车开到墙边，坐上人就很明显了。还有不知道你们发现没有，当你在上坡时或者下坡时灯光会根据路段的变化而变化，下坡会把灯光往下聚集，因为在马自达的左后悬挂下有一个接收感应数据的随动传感器，连接部分的是一节球头，当车辆上坡车的重心在车尾，后悬挂下摆臂弹簧弹起，球头杆受感应，纵向角度拉长。由传感器传输数据到ecu再传输到大灯模组控制单元根据数据调整光聚(下坡同理)</p><h2 id="CX5锁车，车尾门电子锁"><a href="#CX5锁车，车尾门电子锁" class="headerlink" title="CX5锁车，车尾门电子锁"></a>CX5锁车，车尾门电子锁</h2><p>1。CX5停车按下一键启动熄火后，发现后面2个车窗没关，不用再按一键启动通电后升玻璃，只要4个车门没有开车门的动作，就可以直接在主驾驶升车窗玻璃，如果乘客已经开车门，下车后长按遥控器锁车键可以自动关闭4门车窗。相反长按解锁键自动降下车窗。<br>2。车尾门开门把手右边10厘米，有个电子锁车按钮(只能锁，不能开)<br>3。后排座椅靠背有2档可调，跑长途坐累了只需要在靠背上端把塑料抠手抬一下即可往后放躺几度，长途更舒适。<br>4。后挡除霜开关即后视镜除霜开关。两者同一个开关，很多新车主不知道。<br>5。大灯高度调节是自动的。点火后，行车电脑会根据当前车重自动调节高低，当然也可以打开机盖用一把十字起，垂直插入大灯后方的圆孔里自己调节。<br>6。车机悦联系统是可以播放无损格式音乐的。自己用音乐app下载FLAC无损格式，再用小程序改后缀名为.MP3，车机即可识别播放，建议用SD卡，可腾个USB接口出来。<br>7。建议车主到当地4S店加装胎压显示模块，右视辅助，电动尾门一脚踢开关。这3个功能非常实用。</p><h2 id="音乐功能"><a href="#音乐功能" class="headerlink" title="音乐功能"></a>音乐功能</h2><p>令天发现了马三的隐藏小功能，当音乐在播放时候轻点一下音乐就会暂停，点俩下就会换下一首！功能虽小但是很实用，驾驶时不用分心了！车行千里，安全第一！为马三点赞！</p><h2 id="放倒后排座椅，钥匙无法开门启动"><a href="#放倒后排座椅，钥匙无法开门启动" class="headerlink" title="放倒后排座椅，钥匙无法开门启动"></a>放倒后排座椅，钥匙无法开门启动</h2><p>次世代马自达3<br>在副驾驶后排位置，找到隐藏开关，扣开顺着箭头的方向掰动按键，这样就能放到后排座椅了。<br>当遥控钥匙无法开门时，用机械钥匙，拉开门把手，一拧门就开了。<br>车辆挂P挡时候再按键的上面有盖子，扣开，用坚硬的物体捅下，就能解锁推车了。</p><h2 id="智能钥匙的功能："><a href="#智能钥匙的功能：" class="headerlink" title="智能钥匙的功能："></a>智能钥匙的功能：</h2><p>1、携带钥匙贴近车辆，触模主驾驶车门把手的感应区，可以智能开启或锁止车门。<br>2、遥控钥匙失灵或电池没电，可以打开隐藏的钥匙手动开锁，进入车内。<br>3、智能钥匙无电，将钥匙贴在方向盘右侧下面带有钥匙标志的感应区，可以启动车辆。<br>4、停车熄火后，长按锁止键，可以一键升窗或落窗。<br>5、长按带有背箱开启标志的按键，可以开启或关闭后备箱。<br>6、携带钥匙靠近车辆，用脚扫扫后导流板下面，可以感应开启后备箱。</p><h2 id="座椅迎宾功能"><a href="#座椅迎宾功能" class="headerlink" title="座椅迎宾功能"></a>座椅迎宾功能</h2><p>座椅迎宾功能!有电动座椅这项功能的车主可以看下说明手册，只要调节好自己的座椅，后视镜，储存激活。如果有人开了你的车，你上车还要调整你舒适的坐姿，这个时候只需要电子钥匙在身边，使用无钥匙进入，打开车门，你会发现座椅和后视镜会自动的在调整，调整到你设置好的坐姿和后视镜角度!</p><h2 id="无钥匙进入功能失灵各种情况"><a href="#无钥匙进入功能失灵各种情况" class="headerlink" title="无钥匙进入功能失灵各种情况"></a>无钥匙进入功能失灵各种情况</h2><p>锁车自动落锁功能需要在中控屏幕设置打开离车落锁功能，注意次时代无钥匙进入需要下车关门，并且出现滴的一声才会自动落锁！<br>分析无钥匙进入功能失灵各种情况：<br>可能会出现自动落锁（下车自动锁车）失灵的操作：<br>0.钥匙进入了省电模式（一般是这个原因的多）-退出即可<br>1.主副驾驶门不是最后一个关闭<br>2.车门，后尾箱没有关闭<br>3.副驾驶上的门把手有人在摸着不放<br>4.雨天门把手湿了<br>5.把手插进门把手里面关门<br>6.钥匙套是金属的<br>7.钥匙距离过远<br>8.拉开车门，短时间内又关车门<br>9.钥匙电量不足<br>可能会出现无钥匙进入（上车自动解锁）失灵的操作:<br>1.钥匙进入了省电模式-退出即可<br>2.上车的时候副驾驶比你先摸门把手<br>3.没有把手插入门把手里面拉<br>4.门把手有水<br>5.钥匙电量不足<br>6.钥匙套是金属的<br>7.钥匙距离过远</p><h2 id="儿童锁"><a href="#儿童锁" class="headerlink" title="儿童锁"></a>儿童锁</h2><p>最实用的功能莫过于左右后车门的儿童锁了，别看只是那一点点的白色小按钮，安全作用不言而喻，孩子玩嗨了，上车下车就会把安全抛之脑后，等红绿灯时也不用担心她们随意下车，很安全的设计！</p><hr><blockquote><p><strong>说明：本文是收集参考文档，以方便查看</strong></p></blockquote><hr><h1 id="信息链接"><a href="#信息链接" class="headerlink" title="信息链接:"></a>信息链接:</h1><ol><li><a href="https://mp.weixin.qq.com/s/I-e1iIVbQKoBonOJr3t7Kg">钥匙中止功能，很多老司机也不一定知道！</a></li></ol><hr><center><font color="red">=================我是分割线=================</font></center><p><strong>欢迎到公众号来唠嗑:</strong></p><img src="https://pic4.zhimg.com/80/v2-eedc5dc7d30beedf4c2f1812df8e61a7_720w.jpg">]]></content>
    
    
    <summary type="html">收集各类马自达钥匙技巧</summary>
    
    
    
    <category term="生活技能" scheme="https://zml3589110.github.io/categories/%E7%94%9F%E6%B4%BB%E6%8A%80%E8%83%BD/"/>
    
    <category term="马自达" scheme="https://zml3589110.github.io/categories/%E9%A9%AC%E8%87%AA%E8%BE%BE/"/>
    
    
    <category term="汽车" scheme="https://zml3589110.github.io/tags/%E6%B1%BD%E8%BD%A6/"/>
    
    <category term="马自达" scheme="https://zml3589110.github.io/tags/%E9%A9%AC%E8%87%AA%E8%BE%BE/"/>
    
    <category term="生活类" scheme="https://zml3589110.github.io/tags/%E7%94%9F%E6%B4%BB%E7%B1%BB/"/>
    
  </entry>
  
</feed>
